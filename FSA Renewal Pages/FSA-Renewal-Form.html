<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NueSynergy FSA Plan Renewal</title>
    <!-- Performance: Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style">
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    
    <!-- Load CSS and JavaScript -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        :root {
            --primary-blue: #1E4E6B;
            --secondary-green: #A4C639;
            --background-light: #F0F4F0;
            --text-dark: #333333;
            --text-light: #666666;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-light);
            color: var(--text-dark);
            position: relative;
            overflow-x: hidden;
        }
        
        
        .nue-primary {
            background-color: var(--primary-blue);
        }
        
        .nue-secondary {
            background-color: var(--secondary-green);
        }
        
        .nue-primary-text {
            color: var(--primary-blue);
        }
        
        .nue-secondary-text {
            color: var(--secondary-green);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--secondary-green) 0%, var(--primary-blue) 100%);
        }
        
        .step-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(30, 78, 107, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(30, 78, 107, 0.1);
        }
        
        .step-card:hover {
            box-shadow: 0 16px 48px rgba(30, 78, 107, 0.15);
            transform: translateY(-2px);
        }
        
        .form-input {
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 12px 16px;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .form-input:focus {
            border-color: var(--secondary-green);
            box-shadow: 0 0 0 3px rgba(164, 198, 57, 0.1);
            outline: none;
        }
        
        .form-input.error {
            border-color: #EF4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .checkbox-custom {
            accent-color: var(--secondary-green);
            transform: scale(1.2);
        }
        
        .radio-custom {
            accent-color: var(--secondary-green);
            transform: scale(1.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-green) 100%);
            color: white;
            padding: 14px 32px;
            border-radius: 8px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(30, 78, 107, 0.3);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-secondary:hover {
            background: var(--primary-blue);
            color: white;
        }
        
        .hidden {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Enhanced animations for anime.js */
        .animate-in {
            opacity: 0;
            transform: translateY(30px);
        }
        
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        /* Process visualization */
        .process-visualization {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(30, 78, 107, 0.1);
        }
        
        /* Journey Step Cards */
        .journey-step {
            position: relative;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1.5rem 1rem;
            transition: all 0.3s ease;
            cursor: default;
            overflow: hidden;
        }
        
        .journey-step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--secondary-green), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .journey-step:hover::before {
            transform: translateX(100%);
        }
        
        .journey-step-inner {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .journey-icon-wrapper {
            position: relative;
            width: 60px;
            height: 60px;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #f0f4f0 0%, #e5e7eb 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .journey-icon {
            font-size: 1.5rem;
            color: #6b7280;
            transition: all 0.3s ease;
        }
        
        .journey-number {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #6b7280 0%, #9ca3af 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .journey-checkmark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 70px;
            height: 70px;
            background: var(--secondary-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 2;
        }
        
        .journey-checkmark i {
            color: white;
            font-size: 1.75rem;
            font-weight: bold;
        }
        
        .journey-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .journey-description {
            font-size: 0.75rem;
            color: #9ca3af;
            line-height: 1.3;
            transition: all 0.3s ease;
        }
        
        /* ACTIVE STATE - Current Step */
        .journey-step.active {
            background: linear-gradient(135deg, #A4C639 0%, #8fb030 100%);
            border-color: #A4C639;
            box-shadow: 0 8px 24px rgba(164, 198, 57, 0.3);
            transform: translateY(-4px);
        }
        
        .journey-step.active .journey-icon-wrapper {
            background: rgba(255, 255, 255, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }
        
        .journey-step.active .journey-icon {
            color: white;
            transform: scale(1.1);
        }
        
        .journey-step.active .journey-number {
            background: linear-gradient(135deg, #1E4E6B 0%, #2a5f7f 100%);
            box-shadow: 0 4px 12px rgba(30, 78, 107, 0.4);
        }
        
        .journey-step.active .journey-title,
        .journey-step.active .journey-description {
            color: white;
        }
        
        /* COMPLETED STATE - Past Steps */
        .journey-step.completed {
            background: linear-gradient(135deg, #1E4E6B 0%, #2a5f7f 100%);
            border-color: #1E4E6B;
            box-shadow: 0 4px 16px rgba(30, 78, 107, 0.2);
        }
        
        .journey-step.completed .journey-icon-wrapper {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .journey-step.completed .journey-icon {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .journey-step.completed .journey-checkmark {
            transform: translate(-50%, -50%) scale(1);
        }
        
        .journey-step.completed .journey-checkmark.hidden {
            display: flex !important;
        }
        
        .journey-step.completed .journey-number {
            background: linear-gradient(135deg, #A4C639 0%, #8fb030 100%);
        }
        
        .journey-step.completed .journey-title,
        .journey-step.completed .journey-description {
            color: white;
        }
        
        /* PENDING STATE - Future Steps */
        .journey-step.pending {
            opacity: 0.7;
        }
        
        .journey-step.pending:hover {
            opacity: 0.85;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Progress Bar Shimmer Effect */
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }
        
        .animate-shimmer {
            animation: shimmer 2s infinite;
        }
        
        /* Pulse Animation */
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .journey-step {
                padding: 1rem 0.75rem;
            }
            
            .journey-icon-wrapper {
                width: 50px;
                height: 50px;
            }
            
            .journey-icon {
                font-size: 1.25rem;
            }
            
            .journey-number {
                width: 24px;
                height: 24px;
                font-size: 0.7rem;
            }
            
            .journey-title {
                font-size: 0.85rem;
            }
            
            .journey-description {
                font-size: 0.7rem;
            }
        }
        
        .signature-pad {
            border: 2px dashed #E5E7EB;
            border-radius: 8px;
            cursor: crosshair;
        }
        
        .signature-pad.active {
            border-color: var(--secondary-green);
            background-color: #fafafa;
        }
        
        .error-message {
            color: #EF4444;
            font-size: 14px;
            margin-top: 4px;
        }
        
        .success-message {
            color: var(--secondary-green);
            font-size: 14px;
            margin-top: 4px;
        }
        
        .field-group {
            margin-bottom: 24px;
        }
        
        .field-label {
            display: block;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-dark);
        }
        
        .required {
            color: #EF4444;
        }
        
        /* Accessibility: Respect user motion preferences */
        @media (prefers-reduced-motion: reduce) {
            .step-card {
                transition: none;
            }
            
            .step-card:hover {
                transform: none;
                box-shadow: 0 8px 32px rgba(30, 78, 107, 0.1);
            }
            
            .btn-primary:hover {
                transform: none;
            }
            
            .form-input {
                transition: none;
            }
            
            .fade-in {
                animation: none;
            }
            
            .progress-bar {
                transition: none;
            }
        }
        
        /* Enhanced focus styles for accessibility */
        .form-input:focus {
            outline: 3px solid var(--secondary-green);
            outline-offset: 2px;
            border-color: var(--secondary-green);
            box-shadow: 0 0 0 3px rgba(164, 198, 57, 0.1);
        }
        
        .btn-primary:focus,
        .btn-secondary:focus {
            outline: 3px solid var(--secondary-green);
            outline-offset: 2px;
        }
        
        /* Skip link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-blue);
            color: white;
            padding: 8px;
            z-index: 1000;
            text-decoration: none;
            border-radius: 4px;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .step-indicator {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .step-card {
                margin: 0 8px;
                border-radius: 12px;
            }
            
            .btn-primary, .btn-secondary {
                width: 100%;
                margin-bottom: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-6xl mx-auto">
            
            <!-- Header -->
            <header role="banner" class="text-center mb-8 animate-in">
                <h1 class="text-4xl font-bold nue-primary-text mb-3 floating-animation">NueSynergy</h1>
                <h2 class="text-2xl font-semibold text-gray-700 mb-2">FSA Plan Renewal</h2>
                <p class="text-gray-600 max-w-3xl mx-auto">
                    Thank you for choosing to renew your Benefit Account Plan with NueSynergy for the upcoming plan year. 
                    Complete this renewal form to continue your FSA services.
                </p>
            </header>
            
            <!-- Your Journey - Enhanced Interactive Progress Tracker -->
            <nav role="navigation" aria-label="Form progress" class="mb-8">
                <div class="process-visualization animate-in" id="journey-tracker">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 class="text-2xl font-bold nue-primary-text flex items-center">
                                <i class="fas fa-route mr-3 text-3xl"></i>Your Journey
                            </h3>
                            <p class="text-sm text-gray-600 mt-1 ml-12">Track your progress through the renewal process</p>
                        </div>
                        <div class="text-right">
                            <span class="text-3xl font-bold nue-secondary-text" id="progressText">Step 1</span>
                            <p class="text-sm text-gray-600">of 4 steps</p>
                        </div>
                    </div>
                    
                    <!-- Progress Bar with Gradient -->
                    <div class="relative w-full bg-gray-200 rounded-full h-3 mb-8 overflow-hidden">
                        <div class="progress-bar h-3 rounded-full transition-all duration-700 ease-out relative" id="progressBar" style="width: 25%">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-shimmer"></div>
                        </div>
                    </div>
                    
                    <!-- Interactive Step Cards -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <!-- Step 1 -->
                        <div class="journey-step active" id="journey-step-1" data-step="1">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-building journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">1</div>
                                <h4 class="journey-title">Employer Info</h4>
                                <p class="journey-description">Basic company details</p>
                            </div>
                        </div>
                        
                        <!-- Step 2 -->
                        <div class="journey-step pending" id="journey-step-2" data-step="2">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-users journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">2</div>
                                <h4 class="journey-title">Contacts</h4>
                                <p class="journey-description">Key contact updates</p>
                            </div>
                        </div>
                        
                        <!-- Step 3 -->
                        <div class="journey-step pending" id="journey-step-3" data-step="3">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-cogs journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">3</div>
                                <h4 class="journey-title">Plan Setup</h4>
                                <p class="journey-description">Benefit configurations</p>
                            </div>
                        </div>
                        
                        <!-- Step 4 -->
                        <div class="journey-step pending" id="journey-step-4" data-step="4">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-signature journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">4</div>
                                <h4 class="journey-title">Authorization</h4>
                                <p class="journey-description">Sign & submit</p>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Status announcements for screen readers -->
            <div id="status-message" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
            <div id="error-message" class="sr-only" role="alert" aria-live="assertive" aria-atomic="true"></div>

            <!-- Main Form Content -->
            <main role="main" id="main-content">
                <form id="fsaRenewalForm" class="space-y-8" aria-label="FSA Plan Renewal Form">
                
                <!-- Step 1: Employer Information -->
                <section class="step-card p-8 fade-in" id="step1" aria-labelledby="step1-heading">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator" aria-hidden="true">1</div>
                        <h3 id="step1-heading" class="text-3xl font-bold nue-primary-text">Employer Information</h3>
                    </div>
                    
                    <p class="text-gray-600 mb-6">Please provide your basic employer details to help us identify your account.</p>
                    
                    <fieldset class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <legend class="text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-building mr-2" aria-hidden="true"></i>Company Information
                        </legend>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="field-group">
                                <label for="firstName" class="field-label">First Name <span class="required">*</span></label>
                                <input type="text" id="firstName" name="firstName" required class="form-input w-full" aria-required="true">
                            </div>
                            
                            <div class="field-group">
                                <label for="lastName" class="field-label">Last Name <span class="required">*</span></label>
                                <input type="text" id="lastName" name="lastName" required class="form-input w-full" aria-required="true">
                            </div>
                            
                            <div class="field-group">
                                <label for="email" class="field-label">Email <span class="required">*</span></label>
                                <input type="email" id="email" name="email" required class="form-input w-full" aria-required="true">
                            </div>
                            
                            <div class="field-group">
                                <label for="phone" class="field-label">Phone <span class="required">*</span></label>
                                <input type="tel" id="phone" name="phone" required class="form-input w-full" aria-required="true">
                            </div>
                        </div>
                        
                        <div class="field-group mt-6">
                            <label class="flex items-start">
                                <input type="checkbox" id="termsAgreement" name="termsAgreement" required class="checkbox-custom mt-1 mr-3" aria-required="true">
                                <span class="text-sm text-gray-700">
                                    I agree to <a href="https://nuesynergy.com/terms-of-use/" target="_blank" class="text-blue-600 hover:underline">terms & conditions</a> provided by NueSynergy. 
                                    By providing my contact information, I agree to receive text and email messages from NueSynergy. <span class="required">*</span>
                                </span>
                            </label>
                        </div>
                    </fieldset>
                </section>

                <!-- Step 2: Contact Updates -->
                <section class="step-card p-8 fade-in hidden" id="step2" aria-labelledby="step2-heading">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator" aria-hidden="true">2</div>
                        <h3 id="step2-heading" class="text-3xl font-bold nue-primary-text">Contact Information</h3>
                    </div>
                    
                    <p class="text-gray-600 mb-6">Review and update your contact information if needed.</p>
                    
                    <fieldset class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <legend class="text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-user mr-2" aria-hidden="true"></i>Current Primary Contact
                        </legend>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="text-sm text-gray-700">
                                <p class="mb-2"><strong>Title:</strong> <span id="currentTitle">Team Lead</span></p>
                                <p class="mb-2"><strong>Name:</strong> <span id="currentName">Kristen Gochenour</span></p>
                                <p class="mb-2"><strong>Phone:</strong> <span id="currentPhone">+15403350918</span></p>
                                <p><strong>Email:</strong> <span id="currentEmail">kristen.gochenour@nuesynergy.com</span></p>
                            </div>
                        </div>
                        
                        <div class="field-group">
                            <label for="updateContact" class="field-label">Do you need to make changes to the above Primary Contact details? <span class="required">*</span></label>
                            <select id="updateContact" name="updateContact" required class="form-input w-full" onchange="toggleContactFields()" aria-required="true">
                                <option value="">Select an option</option>
                                <option value="no">No, keep current contact</option>
                                <option value="yes">Yes, I need to update</option>
                            </select>
                        </div>
                        
                        <div id="newContactFields" class="hidden mt-6">
                            <h4 class="text-lg font-medium nue-primary-text mb-4">New Contact Information</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="field-group">
                                    <label for="newContactTitle" class="field-label">Title</label>
                                    <input type="text" id="newContactTitle" name="newContactTitle" class="form-input w-full">
                                </div>
                                
                                <div class="field-group">
                                    <label for="newContactName" class="field-label">Name</label>
                                    <input type="text" id="newContactName" name="newContactName" class="form-input w-full">
                                </div>
                                
                                <div class="field-group">
                                    <label for="newContactPhone" class="field-label">Phone</label>
                                    <input type="tel" id="newContactPhone" name="newContactPhone" class="form-input w-full">
                                </div>
                                
                                <div class="field-group">
                                    <label for="newContactEmail" class="field-label">Email</label>
                                    <input type="email" id="newContactEmail" name="newContactEmail" class="form-input w-full">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </section>

                <!-- Step 3: Plan Setup -->
                <section class="step-card p-8 fade-in hidden" id="step3" aria-labelledby="step3-heading">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator" aria-hidden="true">3</div>
                        <h3 id="step3-heading" class="text-3xl font-bold nue-primary-text">Plan Setup & Configuration</h3>
                    </div>
                    
                    <p class="text-gray-600 mb-6">Review your current benefits and plan dates, and make any necessary updates.</p>
                    
                    <fieldset class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <legend class="text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-calendar-alt mr-2" aria-hidden="true"></i>Current Plan Information
                        </legend>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <div class="text-sm text-gray-700">
                                <p class="mb-3"><strong>Current Benefits:</strong> Health Care FSA, Dependent Care FSA, Limited Purpose FSA (Vision and Dental only)</p>
                                <p class="mb-2"><strong>Plan Year Start Date:</strong> January 1, 2026</p>
                                <p class="mb-2"><strong>Plan Year End Date:</strong> December 31, 2026</p>
                            </div>
                        </div>
                        
                        <div class="field-group">
                            <label for="updatePlanDates" class="field-label">Do you want to update your current benefits and plan dates? <span class="required">*</span></label>
                            <select id="updatePlanDates" name="updatePlanDates" required class="form-input w-full" onchange="togglePlanFields()" aria-required="true">
                                <option value="">Select an option</option>
                                <option value="no">No, keep current plan configuration</option>
                                <option value="yes">Yes, I need to update</option>
                            </select>
                        </div>
                        
                        <div id="newPlanFields" class="hidden mt-6">
                            <h4 class="text-lg font-medium nue-primary-text mb-4">New Plan Configuration</h4>
                            
                            <div class="field-group">
                                <label class="field-label">Select Benefits</label>
                                <div class="space-y-2">
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="checkbox" name="benefits" value="healthcare-fsa" class="checkbox-custom mr-3">
                                        <span>Health Care FSA</span>
                                    </label>
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="checkbox" name="benefits" value="dependent-care-fsa" class="checkbox-custom mr-3">
                                        <span>Dependent Care FSA</span>
                                    </label>
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="checkbox" name="benefits" value="limited-purpose-fsa" class="checkbox-custom mr-3">
                                        <span>Limited Purpose FSA (Vision and Dental only)</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                                <div class="field-group">
                                    <label for="planYearStart" class="field-label">Plan Year Start Date</label>
                                    <input type="date" id="planYearStart" name="planYearStart" class="form-input w-full">
                                </div>
                                
                                <div class="field-group">
                                    <label for="planYearEnd" class="field-label">Plan Year End Date</label>
                                    <input type="date" id="planYearEnd" name="planYearEnd" class="form-input w-full">
                                </div>
                            </div>
                        </div>
                        
                        <div class="field-group mt-6">
                            <label for="openEnrollmentEnd" class="field-label">Open Enrollment End Date <span class="required">*</span></label>
                            <input type="date" id="openEnrollmentEnd" name="openEnrollmentEnd" required class="form-input w-full" aria-required="true">
                            <p class="text-sm text-gray-600 mt-2">
                                <i class="fas fa-info-circle mr-1"></i>
                                To ensure enrollments are completed and cards are mailed out in a timely manner, we recommend your open enrollment is closed at least 20 days before your renewal date.
                            </p>
                        </div>
                    </fieldset>
                </section>

                <!-- Step 4: Signature -->
                <section class="step-card p-8 fade-in hidden" id="step4" aria-labelledby="step4-heading">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator" aria-hidden="true">4</div>
                        <h3 id="step4-heading" class="text-3xl font-bold nue-primary-text">Authorization & Signature</h3>
                    </div>
                    
                    <p class="text-gray-600 mb-6">Please review and sign to complete your FSA plan renewal.</p>
                    
                    <fieldset class="mb-8 p-6 bg-gradient-to-br from-blue-50 to-gray-50 rounded-lg border border-blue-200">
                        <legend class="text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-file-signature mr-2" aria-hidden="true"></i>Digital Signature <span class="required">*</span>
                        </legend>
                        
                        <div class="mb-4">
                            <label for="signerName" class="field-label">Submitter Name <span class="required">*</span></label>
                            <input type="text" id="signerName" name="signerName" required class="form-input w-full" placeholder="Enter your full name" aria-required="true">
                        </div>
                        
                        <div class="mb-4">
                            <label class="field-label">Draw Your Signature Below <span class="required">*</span></label>
                            <div class="signature-pad-wrapper bg-white rounded-lg p-4">
                                <canvas id="signaturePad" class="signature-pad w-full" style="border: 2px dashed #E5E7EB; border-radius: 8px; height: 200px;"></canvas>
                            </div>
                            <div class="flex justify-end mt-2">
                                <button type="button" id="clearSignature" class="text-sm text-red-600 hover:text-red-800 font-medium">
                                    <i class="fas fa-eraser mr-1"></i>Clear Signature
                                </button>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">
                                <i class="fas fa-info-circle mr-1"></i>
                                By signing, you confirm that the information provided is accurate and authorize the renewal of your FSA plan.
                            </p>
                        </div>
                    </fieldset>
                    
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    <strong>Important Reminders:</strong>
                                </p>
                                <ul class="text-sm text-yellow-700 mt-2 list-disc list-inside">
                                    <li>Complete all sections before submitting or your information will not be saved</li>
                                    <li>Have a copy of your payroll calendar available</li>
                                    <li>Submit at least 20 days before your new plan year start date</li>
                                    <li>A discrimination testing eform will be emailed upon completion</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Navigation Buttons -->
                <div class="flex justify-between items-center mt-8">
                    <button type="button" id="prevBtn" class="btn-secondary hidden" onclick="prevStep()">
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    <button type="button" id="nextBtn" class="btn-primary ml-auto" onclick="nextStep()">
                        Next<i class="fas fa-arrow-right ml-2"></i>
                    </button>
                    <button type="submit" id="submitBtn" class="btn-primary ml-auto hidden">
                        <i class="fas fa-check-circle mr-2"></i>Submit Renewal
                    </button>
                </div>

                </form>
            </main>

            <!-- Footer Information -->
            <footer role="contentinfo" class="mt-12 text-center text-sm text-gray-600">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto mb-6">
                    <div>
                        <h4 class="font-semibold nue-primary-text mb-2">
                            <i class="fas fa-building mr-2"></i>Headquarters
                        </h4>
                        <p>NueSynergy</p>
                        <p>4601 College Blvd (Suite 280)</p>
                        <p>Leawood, KS 66211</p>
                    </div>
                    <div>
                        <h4 class="font-semibold nue-primary-text mb-2">
                            <i class="fas fa-headset mr-2"></i>Customer Service
                        </h4>
                        <p>1-855-890-7239 (option 2)</p>
                        <p>CustomerService@NueSynergy.com</p>
                    </div>
                    <div>
                        <h4 class="font-semibold nue-primary-text mb-2">
                            <i class="fas fa-life-ring mr-2"></i>Employer Support
                        </h4>
                        <p>1-855-890-7239 (option 3)</p>
                        <p>EmployerSupport@NueSynergy.com</p>
                    </div>
                </div>
                <p class="text-xs">© 2025 NueSynergy. All rights reserved. | <a href="https://nuesynergy.com/terms-of-use/" target="_blank" class="nue-secondary-text hover:underline">Terms of Use</a></p>
            </footer>
        </div>
    </div>

    <script>
        'use strict';

        // Constants
        const TOTAL_STEPS = 4;
        let currentStep = 1;
        let signaturePad = null;

        // Initialize signature pad
        function initSignaturePad() {
            const canvas = document.getElementById('signaturePad');
            if (canvas && !signaturePad) {
                // Resize canvas to match display size
                const ratio = Math.max(window.devicePixelRatio || 1, 1);
                canvas.width = canvas.offsetWidth * ratio;
                canvas.height = canvas.offsetHeight * ratio;
                canvas.getContext('2d').scale(ratio, ratio);
                
                signaturePad = new SignaturePad(canvas, {
                    backgroundColor: 'rgb(255, 255, 255)',
                    penColor: 'rgb(30, 78, 107)'
                });
            }
        }

        // Clear signature
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            
            document.getElementById('clearSignature')?.addEventListener('click', function() {
                if (signaturePad) {
                    signaturePad.clear();
                }
            });
        });

        // Toggle contact fields
        function toggleContactFields() {
            const select = document.getElementById('updateContact');
            const fields = document.getElementById('newContactFields');
            const inputs = fields.querySelectorAll('input');
            
            if (select.value === 'yes') {
                fields.classList.remove('hidden');
                inputs.forEach(input => input.required = true);
            } else {
                fields.classList.add('hidden');
                inputs.forEach(input => {
                    input.required = false;
                    input.value = '';
                });
            }
        }

        // Toggle plan fields
        function togglePlanFields() {
            const select = document.getElementById('updatePlanDates');
            const fields = document.getElementById('newPlanFields');
            
            if (select.value === 'yes') {
                fields.classList.remove('hidden');
            } else {
                fields.classList.add('hidden');
                fields.querySelectorAll('input').forEach(input => input.value = '');
            }
        }

        // Validate current step
        function validateCurrentStep() {
            const currentStepElement = document.getElementById(`step${currentStep}`);
            if (!currentStepElement) return false;
            
            const requiredFields = currentStepElement.querySelectorAll('[required]');
            let isValid = true;
            
            // Clear previous errors
            currentStepElement.querySelectorAll('.error').forEach(field => {
                field.classList.remove('error');
            });
            
            for (const field of requiredFields) {
                // Skip validation if field or parent is hidden
                const parentDiv = field.closest('div[id$="Fields"]');
                if (parentDiv && parentDiv.classList.contains('hidden')) {
                    continue;
                }
                
                // Also check if field itself is hidden
                if (field.offsetParent === null) {
                    continue;
                }
                
                // Special validation for signature
                if (field.id === 'signaturePad') {
                    if (!signaturePad || signaturePad.isEmpty()) {
                        alert('Please provide your signature before submitting.');
                        isValid = false;
                    }
                    continue;
                }
                
                // Validate based on field type
                if (field.type === 'checkbox' && field.hasAttribute('required')) {
                    if (!field.checked) {
                        field.classList.add('error');
                        isValid = false;
                    }
                } else if (!field.value.trim()) {
                    field.classList.add('error');
                    isValid = false;
                }
            }
            
            if (!isValid) {
                announceError('Please fill in all required fields before continuing.');
            }
            
            return isValid;
        }

        // Navigate to next step
        function nextStep() {
            if (validateCurrentStep()) {
                if (currentStep < TOTAL_STEPS) {
                    currentStep++;
                    updateDisplay();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    announceToScreenReader(`Moved to step ${currentStep}`);
                }
            }
        }

        // Navigate to previous step
        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateDisplay();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                announceToScreenReader(`Moved back to step ${currentStep}`);
            }
        }

        // Update display
        function updateDisplay() {
            // Hide all steps
            for (let i = 1; i <= TOTAL_STEPS; i++) {
                const stepElement = document.getElementById(`step${i}`);
                if (stepElement) {
                    stepElement.classList.add('hidden');
                }
            }
            
            // Show current step
            const currentStepElement = document.getElementById(`step${currentStep}`);
            if (currentStepElement) {
                currentStepElement.classList.remove('hidden');
                currentStepElement.classList.add('fade-in');
            }
            
            // Initialize signature pad if on last step
            if (currentStep === TOTAL_STEPS) {
                setTimeout(initSignaturePad, 100);
            }
            
            // Update navigation buttons
            document.getElementById('prevBtn').classList.toggle('hidden', currentStep === 1);
            document.getElementById('nextBtn').classList.toggle('hidden', currentStep === TOTAL_STEPS);
            document.getElementById('submitBtn').classList.toggle('hidden', currentStep !== TOTAL_STEPS);
            
            updateProgress();
        }

        // Update progress
        function updateProgress() {
            const progress = (currentStep / TOTAL_STEPS) * 100;
            
            // Update progress bar
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
            }
            
            // Update step text
            const progressText = document.getElementById('progressText');
            if (progressText) {
                progressText.textContent = `Step ${currentStep}`;
            }
            
            // Update journey step cards
            for (let i = 1; i <= TOTAL_STEPS; i++) {
                const journeyStep = document.getElementById(`journey-step-${i}`);
                if (journeyStep) {
                    journeyStep.className = 'journey-step';
                    
                    if (i < currentStep) {
                        journeyStep.classList.add('completed');
                    } else if (i === currentStep) {
                        journeyStep.classList.add('active');
                    } else {
                        journeyStep.classList.add('pending');
                    }
                }
            }
        }

        // Screen reader announcements
        function announceToScreenReader(message) {
            const statusDiv = document.getElementById('status-message');
            if (statusDiv) {
                statusDiv.textContent = message;
            }
        }

        function announceError(message) {
            const errorDiv = document.getElementById('error-message');
            if (errorDiv) {
                errorDiv.textContent = message;
            }
        }

        // Form submission
        document.getElementById('fsaRenewalForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!validateCurrentStep()) {
                return;
            }
            
            // Collect form data
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            // Add signature
            if (signaturePad && !signaturePad.isEmpty()) {
                data.signature = signaturePad.toDataURL();
            }
            
            // Add metadata
            data.submittedAt = new Date().toISOString();
            data.formType = 'FSA_Plan_Renewal';
            
            console.log('Form data:', data);
            
            // Show success message
            alert('Thank you for completing your FSA Renewal! Your submission has been successfully received. You will soon receive an email with a detailed summary.');
            
            // Reset form
            this.reset();
            if (signaturePad) {
                signaturePad.clear();
            }
            currentStep = 1;
            updateDisplay();
        });

        // Initialize animations
        if (typeof anime !== 'undefined') {
            // Animate header on load
            anime({
                targets: 'header.animate-in',
                opacity: [0, 1],
                translateY: [-30, 0],
                duration: 1200,
                easing: 'easeOutExpo'
            });
            
            // Animate journey tracker
            anime({
                targets: '#journey-tracker',
                opacity: [0, 1],
                translateY: [30, 0],
                duration: 1000,
                delay: 300,
                easing: 'easeOutExpo'
            });
            
            // Animate journey step cards
            anime({
                targets: '.journey-step',
                opacity: [0, 1],
                translateY: [30, 0],
                scale: [0.9, 1],
                delay: anime.stagger(80, {start: 600}),
                duration: 800,
                easing: 'easeOutElastic(1, .6)'
            });
        }
    </script>
</body>
</html>

