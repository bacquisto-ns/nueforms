<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NueSynergy FSA Administration Adoption Agreement</title>
    <!-- Performance: Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style">
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    
    <!-- Load CSS and JavaScript -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        :root {
            --primary-blue: #1E4E6B;
            --secondary-green: #A4C639;
            --background-light: #F0F4F0;
            --text-dark: #333333;
            --text-light: #666666;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-light);
            color: var(--text-dark);
            position: relative;
            overflow-x: hidden;
        }
        
        
        .nue-primary {
            background-color: var(--primary-blue);
        }
        
        .nue-secondary {
            background-color: var(--secondary-green);
        }
        
        .nue-primary-text {
            color: var(--primary-blue);
        }
        
        .nue-secondary-text {
            color: var(--secondary-green);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--secondary-green) 0%, var(--primary-blue) 100%);
        }
        
        .step-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(30, 78, 107, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(30, 78, 107, 0.1);
        }
        
        .step-card:hover {
            box-shadow: 0 16px 48px rgba(30, 78, 107, 0.15);
            transform: translateY(-2px);
        }
        
        .form-input {
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 12px 16px;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .form-input:focus {
            border-color: var(--secondary-green);
            box-shadow: 0 0 0 3px rgba(164, 198, 57, 0.1);
            outline: none;
        }
        
        .form-input.error {
            border-color: #EF4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .checkbox-custom {
            accent-color: var(--secondary-green);
            transform: scale(1.2);
        }
        
        .radio-custom {
            accent-color: var(--secondary-green);
            transform: scale(1.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-green) 100%);
            color: white;
            padding: 14px 32px;
            border-radius: 8px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(30, 78, 107, 0.3);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .btn-secondary:hover {
            background: var(--primary-blue);
            color: white;
        }
        
        .hidden {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Enhanced animations for anime.js */
        .animate-in {
            opacity: 0;
            transform: translateY(30px);
        }
        
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        /* Process visualization */
        .process-visualization {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(30, 78, 107, 0.1);
        }
        
        /* Journey Step Cards */
        .journey-step {
            position: relative;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1.5rem 1rem;
            transition: all 0.3s ease;
            cursor: default;
            overflow: hidden;
        }
        
        .journey-step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--secondary-green), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .journey-step:hover::before {
            transform: translateX(100%);
        }
        
        .journey-step-inner {
            position: relative;
            text-align: center;
        }
        
        .journey-icon-wrapper {
            position: relative;
            width: 60px;
            height: 60px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, #f0f4f0 0%, #e5e7eb 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .journey-icon {
            font-size: 1.5rem;
            color: #6b7280;
            transition: all 0.3s ease;
        }
        
        .journey-number {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #6b7280 0%, #9ca3af 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .journey-checkmark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 70px;
            height: 70px;
            background: var(--secondary-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 2;
        }
        
        .journey-checkmark i {
            color: white;
            font-size: 1.75rem;
            font-weight: bold;
        }
        
        .journey-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .journey-description {
            font-size: 0.75rem;
            color: #9ca3af;
            line-height: 1.3;
            transition: all 0.3s ease;
        }
        
        /* Active State */
        .journey-step.active {
            background: linear-gradient(135deg, #A4C639 0%, #8fb030 100%);
            border-color: #A4C639;
            box-shadow: 0 8px 24px rgba(164, 198, 57, 0.3);
            transform: translateY(-4px);
        }
        
        .journey-step.active .journey-icon-wrapper {
            background: rgba(255, 255, 255, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }
        
        .journey-step.active .journey-icon {
            color: white;
            transform: scale(1.1);
        }
        
        .journey-step.active .journey-number {
            background: linear-gradient(135deg, #1E4E6B 0%, #2a5f7f 100%);
            box-shadow: 0 4px 12px rgba(30, 78, 107, 0.4);
        }
        
        .journey-step.active .journey-title {
            color: white;
            font-weight: 700;
        }
        
        .journey-step.active .journey-description {
            color: rgba(255, 255, 255, 0.9);
        }
        
        /* Completed State */
        .journey-step.completed {
            background: linear-gradient(135deg, #1E4E6B 0%, #2a5f7f 100%);
            border-color: #1E4E6B;
            box-shadow: 0 4px 16px rgba(30, 78, 107, 0.2);
        }
        
        .journey-step.completed .journey-icon-wrapper {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .journey-step.completed .journey-icon {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .journey-step.completed .journey-checkmark {
            transform: translate(-50%, -50%) scale(1);
        }
        
        .journey-step.completed .journey-checkmark.hidden {
            display: flex !important;
        }
        
        .journey-step.completed .journey-number {
            background: linear-gradient(135deg, #A4C639 0%, #8fb030 100%);
        }
        
        .journey-step.completed .journey-title {
            color: white;
        }
        
        .journey-step.completed .journey-description {
            color: rgba(255, 255, 255, 0.8);
        }
        
        /* Pending State */
        .journey-step.pending {
            opacity: 0.7;
        }
        
        .journey-step.pending:hover {
            opacity: 0.85;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Shimmer animation for progress bar */
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }
        
        .animate-shimmer {
            animation: shimmer 2s infinite;
        }
        
        /* Pulse animation */
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .journey-step {
                padding: 1rem 0.75rem;
            }
            
            .journey-icon-wrapper {
                width: 50px;
                height: 50px;
            }
            
            .journey-icon {
                font-size: 1.25rem;
            }
            
            .journey-number {
                width: 24px;
                height: 24px;
                font-size: 0.7rem;
            }
            
            .journey-title {
                font-size: 0.85rem;
            }
            
            .journey-description {
                font-size: 0.7rem;
            }
        }
        
        /* Success animation */
        .success-checkmark {
            width: 80px;
            height: 80px;
            margin: 0 auto;
        }
        
        .success-checkmark .check-icon {
            width: 80px;
            height: 80px;
            position: relative;
            border-radius: 50%;
            box-sizing: content-box;
            border: 4px solid #A4C639;
        }
        
        .success-checkmark .check-icon::before {
            top: 3px;
            left: -2px;
            width: 30px;
            transform-origin: 100% 50%;
            border-radius: 100px 0 0 100px;
        }
        
        .success-checkmark .check-icon::after {
            top: 0;
            left: 30px;
            width: 60px;
            transform-origin: 0 50%;
            border-radius: 0 100px 100px 0;
            animation: rotate-circle 4.25s ease-in;
        }
        
        .success-checkmark .icon-line {
            height: 5px;
            background-color: #A4C639;
            display: block;
            border-radius: 2px;
            position: absolute;
            z-index: 10;
        }
        
        .success-checkmark .icon-line.line-tip {
            top: 46px;
            left: 14px;
            width: 25px;
            transform: rotate(45deg);
            animation: icon-line-tip 0.75s;
        }
        
        .success-checkmark .icon-line.line-long {
            top: 38px;
            right: 8px;
            width: 47px;
            transform: rotate(-45deg);
            animation: icon-line-long 0.75s;
        }
        
        @keyframes icon-line-tip {
            0% { width: 0; left: 1px; top: 19px; }
            54% { width: 0; left: 1px; top: 19px; }
            70% { width: 50px; left: -8px; top: 37px; }
            84% { width: 17px; left: 21px; top: 48px; }
            100% { width: 25px; left: 14px; top: 45px; }
        }
        
        @keyframes icon-line-long {
            0% { width: 0; right: 46px; top: 54px; }
            65% { width: 0; right: 46px; top: 54px; }
            84% { width: 55px; right: 0px; top: 35px; }
            100% { width: 47px; right: 8px; top: 38px; }
        }
        
        
        .signature-pad {
            border: 2px dashed #E5E7EB;
            border-radius: 8px;
            cursor: crosshair;
        }
        
        .signature-pad.active {
            border-color: var(--secondary-green);
            background-color: #fafafa;
        }
        
        .error-message {
            color: #EF4444;
            font-size: 14px;
            margin-top: 4px;
        }
        
        .success-message {
            color: var(--secondary-green);
            font-size: 14px;
            margin-top: 4px;
        }
        
        .field-group {
            margin-bottom: 24px;
        }
        
        .field-label {
            display: block;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-dark);
        }
        
        .required {
            color: #EF4444;
        }
        
        /* Accessibility: Respect user motion preferences */
        @media (prefers-reduced-motion: reduce) {
            .step-card {
                transition: none;
            }
            
            .step-card:hover {
                transform: none;
                box-shadow: 0 8px 32px rgba(30, 78, 107, 0.1);
            }
            
            .btn-primary:hover {
                transform: none;
            }
            
            .form-input {
                transition: none;
            }
            
            .fade-in {
                animation: none;
            }
            
            .progress-bar {
                transition: none;
            }
            
            .step-indicator {
                transition: none;
            }
            
            .contact-section {
                transition: none;
            }
        }
        
        /* Enhanced focus styles for accessibility */
        .form-input:focus {
            outline: 3px solid var(--secondary-green);
            outline-offset: 2px;
            border-color: var(--secondary-green);
            box-shadow: 0 0 0 3px rgba(164, 198, 57, 0.1);
        }
        
        .btn-primary:focus,
        .btn-secondary:focus {
            outline: 3px solid var(--secondary-green);
            outline-offset: 2px;
        }
        
        /* Skip link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-blue);
            color: white;
            padding: 8px;
            z-index: 1000;
            text-decoration: none;
            border-radius: 4px;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Contact section styling */
        .contact-section {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .contact-section:hover {
            border-left-color: var(--secondary-green);
            box-shadow: 0 4px 12px rgba(164, 198, 57, 0.1);
        }
        
        .contact-header {
            display: flex;
            align-items: center;
        }
        
        .contact-icon {
            margin-right: 12px;
            font-size: 1.25rem;
            color: var(--secondary-green);
            min-width: 24px;
        }
        
        /* Icon-specific colors */
        .fas.fa-user {
            color: #3B82F6; /* Blue for primary */
        }
        
        .fas.fa-users {
            color: #10B981; /* Green for secondary */
        }
        
        .fas.fa-file-invoice-dollar {
            color: #F59E0B; /* Amber for invoicing */
        }
        
        .fas.fa-chart-bar {
            color: #8B5CF6; /* Purple for reporting */
        }
        
        /* Responsive contact section */
        @media (max-width: 768px) {
            .contact-section {
                margin-bottom: 1.5rem;
                padding: 1rem;
            }
            
            .contact-header {
                margin-bottom: 1rem;
            }
            
            .contact-icon {
                font-size: 1.1rem;
                margin-right: 8px;
            }
        }

        @media (max-width: 768px) {
            .step-card {
                margin: 0 8px;
                border-radius: 12px;
            }
            
            .btn-primary, .btn-secondary {
                width: 100%;
                margin-bottom: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-6xl mx-auto">
            
            <!-- Header -->
            <header role="banner" class="text-center mb-8 animate-in">
                <h1 class="text-4xl font-bold nue-primary-text mb-3 floating-animation">NueSynergy</h1>
                <h2 class="text-2xl font-semibold text-gray-700 mb-2">FSA Administration Adoption Agreement</h2>
                <p class="text-gray-600 max-w-3xl mx-auto">
                    Complete your Flexible Spending Account administration setup with our comprehensive digital form. 
                    This replaces the traditional 6-page paper agreement with a modern, user-friendly experience.
                </p>
            </header>
            
            <!-- Your Journey - Enhanced Interactive Progress Tracker -->
            <nav role="navigation" aria-label="Form progress" class="mb-8">
                <div class="process-visualization animate-in" id="journey-tracker">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 class="text-2xl font-bold nue-primary-text flex items-center">
                                <i class="fas fa-route mr-3 text-3xl"></i>Your Journey
                            </h3>
                            <p class="text-sm text-gray-600 mt-1 ml-12">Track your progress through the FSA setup</p>
                        </div>
                        <div class="text-right">
                            <span class="text-3xl font-bold nue-secondary-text" id="progressText">Step 1</span>
                            <p class="text-sm text-gray-600">of 6 steps</p>
                        </div>
                    </div>
                    
                    <!-- Progress Bar with Gradient -->
                    <div class="relative w-full bg-gray-200 rounded-full h-3 mb-8 overflow-hidden">
                        <div class="progress-bar h-3 rounded-full transition-all duration-700 ease-out relative" id="progressBar" style="width: 16.67%">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-shimmer"></div>
                        </div>
                    </div>
                    
                    <!-- Interactive Step Cards -->
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                        <!-- Step 1 -->
                        <div class="journey-step active" id="journey-step-1" data-step="1">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-building journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">1</div>
                                <h4 class="journey-title">Employer Info</h4>
                                <p class="journey-description">Company details & contacts</p>
                            </div>
                        </div>
                        
                        <!-- Step 2 -->
                        <div class="journey-step pending" id="journey-step-2" data-step="2">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-cogs journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">2</div>
                                <h4 class="journey-title">Plan Setup</h4>
                                <p class="journey-description">Configure plan details</p>
                            </div>
                        </div>
                        
                        <!-- Step 3 -->
                        <div class="journey-step pending" id="journey-step-3" data-step="3">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-user-check journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">3</div>
                                <h4 class="journey-title">Eligibility</h4>
                                <p class="journey-description">Define participant rules</p>
                            </div>
                        </div>
                        
                        <!-- Step 4 -->
                        <div class="journey-step pending" id="journey-step-4" data-step="4">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-dollar-sign journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">4</div>
                                <h4 class="journey-title">Contributions</h4>
                                <p class="journey-description">Set contribution limits</p>
                            </div>
                        </div>
                        
                        <!-- Step 5 -->
                        <div class="journey-step pending" id="journey-step-5" data-step="5">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-tasks journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">5</div>
                                <h4 class="journey-title">Administration</h4>
                                <p class="journey-description">Admin preferences</p>
                            </div>
                        </div>
                        
                        <!-- Step 6 -->
                        <div class="journey-step pending" id="journey-step-6" data-step="6">
                            <div class="journey-step-inner">
                                <div class="journey-icon-wrapper">
                                    <i class="fas fa-signature journey-icon"></i>
                                    <div class="journey-checkmark hidden">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="journey-number">6</div>
                                <h4 class="journey-title">Authorization</h4>
                                <p class="journey-description">Sign & submit</p>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Status announcements for screen readers -->
            <div id="status-message" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
            <div id="error-message" class="sr-only" role="alert" aria-live="assertive" aria-atomic="true"></div>

            <!-- Main Form Content -->
            <main role="main" id="main-content">
                <form id="fsaForm" class="space-y-8" aria-label="FSA Administration Adoption Agreement Form">
                
                <!-- Step 1: Employer Information -->
                <section class="step-card p-8 fade-in" id="step1" aria-labelledby="step1-heading">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator active" aria-hidden="true">1</div>
                        <h3 id="step1-heading" class="text-3xl font-bold nue-primary-text">Employer Information</h3>
                    </div>
                    
                    <!-- Company Details Section -->
                    <fieldset class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <legend class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-building contact-icon" aria-hidden="true"></i>Company Details
                        </legend>
                        
                        <!-- Row 1: Tax ID and Employer Name -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group">
                                <label class="field-label">Federal Tax ID (9 digits) <span class="required">*</span></label>
                                <input type="text" name="federalTaxId" required pattern="[0-9]{9}" class="form-input w-full" placeholder="123456789">
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">Employer Name <span class="required">*</span></label>
                                <input type="text" name="employerName" required class="form-input w-full">
                            </div>
                        </div>
                        
                        <!-- Row 2: Mailing Address and City -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group">
                                <label class="field-label">Mailing Address <span class="required">*</span></label>
                                <input type="text" name="mailingAddress" required class="form-input w-full">
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">City <span class="required">*</span></label>
                                <input type="text" name="city" required class="form-input w-full">
                            </div>
                        </div>
                        
                        <!-- Row 3: State and ZIP Code -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="field-group">
                                <label class="field-label">State <span class="required">*</span></label>
                                <select name="state" required class="form-input w-full">
                                    <option value="">Select State</option>
                                    <option value="AL">Alabama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="VA">Virginia</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">ZIP Code <span class="required">*</span></label>
                                <input type="text" name="zipCode" required class="form-input w-full">
                            </div>
                        </div>
                    </fieldset>
                    
                    <!-- Contact Information Section -->
                    <fieldset class="mb-8">
                        <legend class="text-xl font-semibold nue-primary-text mb-6">Contact Information</legend>
                        
                        <!-- Primary Contact -->
                        <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200" role="group" aria-labelledby="primary-contact-heading">
                            <h5 id="primary-contact-heading" class="contact-header text-lg font-medium nue-primary-text mb-2">
                                <i class="fas fa-user contact-icon" aria-hidden="true"></i>Primary Contact
                            </h5>
                            <p class="text-sm text-gray-600 mb-4">Main point of contact for plan administration, renewals, and general inquiries</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="field-group">
                                    <label for="primaryContactName" class="field-label">Name <span class="required">*</span></label>
                                    <input type="text" id="primaryContactName" name="primaryContactName" required class="form-input w-full" aria-describedby="primary-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="primaryContactTitle" class="field-label">Title <span class="required">*</span></label>
                                    <input type="text" id="primaryContactTitle" name="primaryContactTitle" required class="form-input w-full" aria-describedby="primary-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="primaryContactPhone" class="field-label">Phone <span class="required">*</span></label>
                                    <input type="tel" id="primaryContactPhone" name="primaryContactPhone" required class="form-input w-full" aria-describedby="primary-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="primaryContactEmail" class="field-label">Email <span class="required">*</span></label>
                                    <input type="email" id="primaryContactEmail" name="primaryContactEmail" required class="form-input w-full" aria-describedby="primary-contact-heading">
                                </div>
                            </div>
                        </div>

                        <!-- Secondary Contact -->
                        <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200" role="group" aria-labelledby="secondary-contact-heading">
                            <h5 id="secondary-contact-heading" class="contact-header text-lg font-medium nue-primary-text mb-2">
                                <i class="fas fa-users contact-icon" aria-hidden="true"></i>Secondary Contact
                            </h5>
                            <p class="text-sm text-gray-600 mb-4">Backup contact for urgent matters and plan administration support</p>
                            
                            <!-- Copy from Primary Checkbox -->
                            <div class="mb-4">
                                <label class="flex items-center p-3 border border-blue-200 bg-blue-50 rounded-lg hover:border-blue-400 cursor-pointer">
                                    <input type="checkbox" id="copyToSecondary" class="checkbox-custom mr-3" onchange="copyFromPrimary('secondary')">
                                    <span class="text-sm font-medium text-blue-800">
                                        <i class="fas fa-copy mr-2" aria-hidden="true"></i>Copy from Primary Contact
                                    </span>
                                </label>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="field-group">
                                    <label for="secondaryContactName" class="field-label">Name <span class="required">*</span></label>
                                    <input type="text" id="secondaryContactName" name="secondaryContactName" required class="form-input w-full" aria-describedby="secondary-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="secondaryContactTitle" class="field-label">Title <span class="required">*</span></label>
                                    <input type="text" id="secondaryContactTitle" name="secondaryContactTitle" required class="form-input w-full" aria-describedby="secondary-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="secondaryContactPhone" class="field-label">Phone <span class="required">*</span></label>
                                    <input type="tel" id="secondaryContactPhone" name="secondaryContactPhone" required class="form-input w-full" aria-describedby="secondary-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="secondaryContactEmail" class="field-label">Email <span class="required">*</span></label>
                                    <input type="email" id="secondaryContactEmail" name="secondaryContactEmail" required class="form-input w-full" aria-describedby="secondary-contact-heading">
                                </div>
                            </div>
                        </div>

                        <!-- Invoicing Contact -->
                        <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200" role="group" aria-labelledby="invoicing-contact-heading">
                            <h5 id="invoicing-contact-heading" class="contact-header text-lg font-medium nue-primary-text mb-2">
                                <i class="fas fa-file-invoice-dollar contact-icon" aria-hidden="true"></i>Invoicing Contact
                            </h5>
                            <p class="text-sm text-gray-600 mb-4">Receives monthly invoices, payment reminders, and billing statements</p>
                            
                            <!-- Copy from Primary Checkbox -->
                            <div class="mb-4">
                                <label class="flex items-center p-3 border border-blue-200 bg-blue-50 rounded-lg hover:border-blue-400 cursor-pointer">
                                    <input type="checkbox" id="copyToInvoicing" class="checkbox-custom mr-3" onchange="copyFromPrimary('invoicing')">
                                    <span class="text-sm font-medium text-blue-800">
                                        <i class="fas fa-copy mr-2" aria-hidden="true"></i>Copy from Primary Contact
                                    </span>
                                </label>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="field-group">
                                    <label for="invoicingContactName" class="field-label">Name <span class="required">*</span></label>
                                    <input type="text" id="invoicingContactName" name="invoicingContactName" required class="form-input w-full" aria-describedby="invoicing-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="invoicingContactTitle" class="field-label">Title <span class="required">*</span></label>
                                    <input type="text" id="invoicingContactTitle" name="invoicingContactTitle" required class="form-input w-full" aria-describedby="invoicing-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="invoicingContactPhone" class="field-label">Phone <span class="required">*</span></label>
                                    <input type="tel" id="invoicingContactPhone" name="invoicingContactPhone" required class="form-input w-full" aria-describedby="invoicing-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="invoicingContactEmail" class="field-label">Email <span class="required">*</span></label>
                                    <input type="email" id="invoicingContactEmail" name="invoicingContactEmail" required class="form-input w-full" aria-describedby="invoicing-contact-heading">
                                </div>
                            </div>
                        </div>

                        <!-- Reporting Contact -->
                        <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200" role="group" aria-labelledby="reporting-contact-heading">
                            <h5 id="reporting-contact-heading" class="contact-header text-lg font-medium nue-primary-text mb-2">
                                <i class="fas fa-chart-bar contact-icon" aria-hidden="true"></i>Reporting Contact
                            </h5>
                            <p class="text-sm text-gray-600 mb-4">Receives scheduled reports, analytics, and participation data</p>
                            
                            <!-- Copy from Primary Checkbox -->
                            <div class="mb-4">
                                <label class="flex items-center p-3 border border-blue-200 bg-blue-50 rounded-lg hover:border-blue-400 cursor-pointer">
                                    <input type="checkbox" id="copyToReporting" class="checkbox-custom mr-3" onchange="copyFromPrimary('reporting')">
                                    <span class="text-sm font-medium text-blue-800">
                                        <i class="fas fa-copy mr-2" aria-hidden="true"></i>Copy from Primary Contact
                                    </span>
                                </label>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="field-group">
                                    <label for="reportingContactName" class="field-label">Name <span class="required">*</span></label>
                                    <input type="text" id="reportingContactName" name="reportingContactName" required class="form-input w-full" aria-describedby="reporting-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="reportingContactTitle" class="field-label">Title <span class="required">*</span></label>
                                    <input type="text" id="reportingContactTitle" name="reportingContactTitle" required class="form-input w-full" aria-describedby="reporting-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="reportingContactPhone" class="field-label">Phone <span class="required">*</span></label>
                                    <input type="tel" id="reportingContactPhone" name="reportingContactPhone" required class="form-input w-full" aria-describedby="reporting-contact-heading">
                                </div>
                                <div class="field-group">
                                    <label for="reportingContactEmail" class="field-label">Email <span class="required">*</span></label>
                                    <input type="email" id="reportingContactEmail" name="reportingContactEmail" required class="form-input w-full" aria-describedby="reporting-contact-heading">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    
                    <!-- Entity Type -->
                    <fieldset class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <legend class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-sitemap contact-icon" aria-hidden="true"></i>Type of Entity <span class="required">*</span>
                        </legend>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="c-corporation" required class="radio-custom mr-3">
                                <span>C Corporation</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="s-corporation" required class="radio-custom mr-3">
                                <span>S Corporation</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="non-profit" required class="radio-custom mr-3">
                                <span>Non-Profit</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="sole-proprietorship" required class="radio-custom mr-3">
                                <span>Sole Proprietorship</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="partnership-llc" required class="radio-custom mr-3">
                                <span>Partnership LLC</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="union" required class="radio-custom mr-3">
                                <span>Union</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="partnership-llp" required class="radio-custom mr-3">
                                <span>Partnership LLP</span>
                            </label>
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="entityType" value="governmental-agency" required class="radio-custom mr-3">
                                <span>Governmental Agency</span>
                            </label>
                        </div>
                    </fieldset>
                    
                    <!-- Administrator Section -->
                    <section class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-users-cog contact-icon" aria-hidden="true"></i>Employer Administrators
                        </h4>
                        <p class="text-gray-600 mb-4">List information for those who can have Plan Administrator website access below:</p>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr class="nue-primary text-white">
                                        <th class="border border-gray-300 p-3 text-left">Name</th>
                                        <th class="border border-gray-300 p-3 text-left">Phone Number</th>
                                        <th class="border border-gray-300 p-3 text-left">E-mail</th>
                                    </tr>
                                </thead>
                                <tbody id="administratorTable">
                                    <tr>
                                        <td class="border border-gray-300 p-2">
                                            <input type="text" name="adminName1" class="form-input w-full">
                                        </td>
                                        <td class="border border-gray-300 p-2">
                                            <input type="tel" name="adminPhone1" class="form-input w-full">
                                        </td>
                                        <td class="border border-gray-300 p-2">
                                            <input type="email" name="adminEmail1" class="form-input w-full">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <button type="button" id="addAdministrator" class="mt-4 btn-secondary">Add Another Administrator</button>
                        </div>
                    </section>
                </section>

                <!-- Step 2: FSA Plan Setup -->
                <div class="step-card p-8 hidden" id="step2">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator active">2</div>
                        <h3 class="text-3xl font-bold nue-primary-text">FSA Plan Setup</h3>
                    </div>
                    
                    <!-- Plan Configuration Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-cogs contact-icon" aria-hidden="true"></i>Plan Configuration
                        </h4>
                        
                        <!-- Plan Type - Span 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Plan Type <span class="required">*</span></label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="planStatus" value="new-group" required class="radio-custom mr-3">
                                    <span>New Group</span>
                                </label>
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="planStatus" value="renewal" required class="radio-custom mr-3">
                                    <span>Renewal</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Original Effective Date - Conditional field spans 2 columns -->
                        <div class="field-group mb-6" id="renewalInfo" style="display: none;">
                            <label class="field-label">Original effective date for reinstated plan:</label>
                            <input type="date" name="originalEffectiveDate" class="form-input w-full">
                        </div>
                        
                        <!-- Row 1: Plan Year Start Date and End Date -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group">
                                <label class="field-label">Plan Year Start Date <span class="required">*</span></label>
                                <input type="date" name="planYearStart" required class="form-input w-full">
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">Plan Year End Date <span class="required">*</span></label>
                                <input type="date" name="planYearEnd" required class="form-input w-full">
                            </div>
                        </div>
                        
                        <!-- Section 125 Plan Documents -->
                        <div class="field-group mb-6">
                            <label class="field-label">Section 125 Plan Documents <span class="required">*</span></label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="planDocument" value="new" required class="radio-custom mr-3" onchange="togglePlanNumberField()">
                                    <span>New Plan Document Required</span>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="planDocument" value="existing" required class="radio-custom mr-3" onchange="togglePlanNumberField()">
                                    <span>Existing Plan Document</span>
                                </label>
                            </div>
                            <p class="text-sm text-red-600 mt-3">
                                <strong>Please Note:</strong> If 10 years or older, a new Plan Document is required.
                            </p>
                        </div>
                        
                        <!-- Plan Number - Conditional field for Existing Plan Document -->
                        <div id="planNumberField" class="field-group mb-6" style="display: none;">
                            <label class="field-label">Plan Number</label>
                            <input type="text" name="planNumber" class="form-input w-full" placeholder="Enter existing plan number">
                        </div>
                        
                        <!-- Upload Existing Plan Documents - Conditional field for Existing Plan Document -->
                        <div id="existingPlanUploadField" class="field-group mb-6" style="display: none;">
                            <label class="field-label">Upload Existing Plan Documents <span class="required">*</span></label>
                            <div class="mt-2">
                                <input type="file" name="existingPlanDocuments" id="existingPlanDocuments" 
                                       accept=".pdf,.doc,.docx" 
                                       class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 border border-gray-300 rounded-lg p-3">
                                <p class="text-sm text-gray-500 mt-2">
                                    Accepted formats: PDF, Word documents. Maximum file size: 10MB.
                                </p>
                            </div>
                            
                            <!-- Upload Instructions -->
                            <div class="mt-4 p-4 bg-blue-50 border-l-4 border-blue-400">
                                <h6 class="font-semibold text-blue-800 mb-2">Upload Requirements</h6>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>• Upload complete existing Section 125 Plan Document</li>
                                    <li>• Document must be current and valid</li>
                                    <li>• If document is 10+ years old, select "New Plan Document Required" instead</li>
                                    <li>• Include any amendments or addendums if applicable</li>
                                </ul>
                            </div>
                        </div>
                        
                        <!-- Short Plan Year - Spans 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Is this a Short Plan Year?</label>
                            <div class="flex space-x-6 mt-2">
                                <label class="flex items-center">
                                    <input type="radio" name="shortPlanYear" value="no" class="radio-custom mr-2" onchange="toggleShortPlanYearFields()">
                                    <span>No</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="shortPlanYear" value="yes" class="radio-custom mr-2" onchange="toggleShortPlanYearFields()">
                                    <span>Yes</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Short Plan Year Details - Conditional fields -->
                        <div id="shortPlanYearDetails" class="mb-8" style="display: none;">
                            <!-- Row 1: Short Plan Year Begin and End Dates -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div class="field-group">
                                    <label class="field-label">Short Plan Year Begins</label>
                                    <input type="date" name="shortPlanYearBegin" class="form-input w-full">
                                </div>
                                
                                <div class="field-group">
                                    <label class="field-label">Short Plan Year Ends</label>
                                    <input type="date" name="shortPlanYearEnd" class="form-input w-full">
                                </div>
                            </div>
                            
                            <!-- Amended Plan Effective Date - Spans 2 columns -->
                            <div class="field-group">
                                <label class="field-label">Amended Plan Effective Date</label>
                                <input type="date" name="amendedPlanEffective" class="form-input w-full">
                            </div>
                        </div>
                        
                        <!-- Employee Information Section -->
                        <div class="mb-6 mt-8">
                            <h5 class="text-lg font-medium nue-primary-text mb-4">
                                <i class="fas fa-users contact-icon" aria-hidden="true"></i>Employee Information
                            </h5>
                            
                            <!-- Row 1: Total Employees and Benefit Eligibles -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div class="field-group">
                                    <label class="field-label">Total Number of Employees <span class="required">*</span></label>
                                    <input type="number" name="totalEmployees" required class="form-input w-full" min="1">
                                </div>
                                
                                <div class="field-group">
                                    <label class="field-label">Total Number of Benefit Eligibles <span class="required">*</span></label>
                                    <input type="number" name="benefitEligibles" required class="form-input w-full" min="1">
                                </div>
                            </div>
                            
                            <!-- Principal Office - Spans 2 columns -->
                            <div class="field-group mb-6">
                                <label class="field-label">Employer's Principal Office</label>
                                <input type="text" name="principalOffice" class="form-input w-full" placeholder="Location of principal office">
                            </div>
                            
                            <!-- Plan Document Requirements - Spans 2 columns -->
                            <div class="p-4 bg-blue-50 border-l-4 border-blue-400">
                                <h5 class="font-semibold text-blue-800 mb-2">Plan Document Requirements</h5>
                                <p class="text-sm text-blue-700">
                                    This plan shall be governed under the laws of the State of Kansas. 
                                    New Plan Document Required if this is a plan year change or major plan modifications.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- FSA Section 125 Pre-Tax Options -->
                    <div class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-check-square contact-icon" aria-hidden="true"></i>FSA & SECTION 125 PRE-TAX OPTIONS
                        </h4>
                        <p class="text-gray-600 mb-6">The following benefit options shall be included in the plan:</p>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Primary FSA Options Column -->
                            <div class="space-y-4">
                                <h5 class="text-lg font-medium nue-primary-text mb-4">Core FSA Plans</h5>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="health-care-fsa" class="checkbox-custom mr-3">
                                    <span>Health Care FSA</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="dependent-care-fsa" class="checkbox-custom mr-3">
                                    <span>Dependent Care FSA</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="limited-purpose-fsa" class="checkbox-custom mr-3">
                                    <span>Limited Purpose FSA<br><small class="text-gray-500">(vision and dental only, orthodontia reimbursement will follow the above election)</small></span>
                                </label>
                                
                                <div class="ml-4 space-y-3 border-l-2 border-gray-200 pl-4">
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="checkbox" name="benefitOptions" value="employees-only-health-care" class="checkbox-custom mr-3">
                                        <span>Optional: Employees Only – Health Care FSA</span>
                                    </label>
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="checkbox" name="benefitOptions" value="employees-dependents-health-care" class="checkbox-custom mr-3">
                                        <span>Employees + Dependents – Health Care FSA</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Additional Benefits Column -->
                            <div class="space-y-4">
                                <h5 class="text-lg font-medium nue-primary-text mb-4">Additional Benefits</h5>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="adoption-assistance" class="checkbox-custom mr-3">
                                    <span>Adoption Assistance Program</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="transportation-reimbursement" class="checkbox-custom mr-3">
                                    <span>Transportation Reimbursement Account</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="group-health-insurance" class="checkbox-custom mr-3">
                                    <span>Pre-taxing of employer's group health insurance premiums<br><small class="text-gray-500">(medical, dental, vision)</small></span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="checkbox" name="benefitOptions" value="group-term-life" class="checkbox-custom mr-3">
                                    <span>Group term life insurance<br><small class="text-gray-500">(value of policy cannot exceed $50,000)</small></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enrollment Method -->
                    <div class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-clipboard-list contact-icon" aria-hidden="true"></i>Enrollment Method <span class="required">*</span>
                        </h4>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="space-y-3">
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="enrollmentMethod" value="paper" required class="radio-custom mr-3">
                                    <span>Paper</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="enrollmentMethod" value="nuesynergy-online" required class="radio-custom mr-3">
                                    <span>NueSynergy Online Enrollment</span>
                                </label>
                            </div>
                            
                            <div class="space-y-3">
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="enrollmentMethod" value="employee-navigator" required class="radio-custom mr-3">
                                    <span>Employee Navigator</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="enrollmentMethod" value="ease" required class="radio-custom mr-3">
                                    <span>Ease</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <label class="field-label">Other (please specify):</label>
                            <input type="text" name="enrollmentMethodOther" class="form-input w-full" placeholder="Specify custom enrollment method">
                        </div>
                    </div>
                </div>

                <!-- Step 3: Eligibility Requirements -->
                <div class="step-card p-8 hidden" id="step3">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator active">3</div>
                        <h3 class="text-3xl font-bold nue-primary-text">Eligibility Requirements</h3>
                    </div>
                    
                    <!-- Employee Eligibility Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-user-check contact-icon" aria-hidden="true"></i>Employee Eligibility
                        </h4>
                        <p class="text-gray-600 mb-6">All employees shall be eligible to participate in the plan, EXCEPT:</p>
                        
                        <!-- Specific Exclusions - Span 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Specific Exclusions</label>
                            <textarea name="eligibilityExclusions" rows="4" class="form-input w-full" placeholder="List any employee categories that are excluded from participation..."></textarea>
                        </div>
                        
                        <!-- Exclusion Checkboxes - Better field pairings -->
                        <div class="space-y-6">
                            <!-- Row 1: IRS Section 125 Officers/Directors and Self-employed persons -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="irs-section-125" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Individuals who are officers/directors subject to Section 125(c) governing Health Savings Accounts</span>
                                </label>
                                
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="self-employed" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Any self-employed person(s), within the meaning of IRS Section 401(c), including independent contractors, greater than 2% shareholder in Subchapter S corporation, partner in partnership, or owner/member of LLC treated like partnership for tax purposes</span>
                                </label>
                            </div>
                            
                            <!-- Row 2: Section 318 relatives and Part-time employees -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="relative-section-318" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">A relative, within the meaning of IRS Section 318, of one of the above self-employed person(s) AND: Employees who are not eligible under the employer's health insurance plan</span>
                                </label>
                                
                                <div class="p-3 border border-gray-200 rounded-lg">
                                    <label class="flex items-start">
                                        <input type="checkbox" name="eligibilityConditions" value="part-time-hours" class="checkbox-custom mt-1 mr-3">
                                        <span class="text-sm">Part-time employees expected to work less than <span class="font-medium">___</span> hours per week</span>
                                    </label>
                                    <input type="number" name="partTimeHours" class="form-input w-20 mt-2 ml-6" placeholder="Hours" min="1" max="40">
                                </div>
                            </div>
                            
                            <!-- Row 3: Commissioned salespersons and Collective bargaining -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="commissioned-salesperson" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Commissioned salespersons</span>
                                </label>
                                
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="collective-bargaining" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Any employee included in a unit covered by collective bargaining agreement unless the agreement requires the employee to be included within the plan</span>
                                </label>
                            </div>
                            
                            <!-- Row 4: Temporary/seasonal and Leased employees -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="temporary-seasonal" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Any employee who is temporary or seasonal (working for less than 6 months of the year)</span>
                                </label>
                                
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="leased-employee" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Any leased employee</span>
                                </label>
                            </div>
                            
                            <!-- Row 5: Non-resident aliens and Other exclusions -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <label class="flex items-start p-3 border border-gray-200 rounded-lg hover:border-green-400">
                                    <input type="checkbox" name="eligibilityConditions" value="non-resident-aliens" class="checkbox-custom mt-1 mr-3">
                                    <span class="text-sm">Non-resident aliens</span>
                                </label>
                                
                                <div class="field-group">
                                    <label class="field-label">Other exclusions:</label>
                                    <input type="text" name="otherExclusions" class="form-input w-full" placeholder="Specify other exclusions">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Plan Entry Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-sign-in-alt contact-icon" aria-hidden="true"></i>Plan Entry <span class="required">*</span>
                        </h4>
                        
                        <!-- Radio button options - Span full width -->
                        <div class="space-y-3 mb-6">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="planEntry" value="same-as-health-plan" required class="radio-custom mr-3">
                                <span>Same as Health Plan</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="planEntry" value="immediately" required class="radio-custom mr-3">
                                <span>Immediately</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="planEntry" value="days-after-hire" required class="radio-custom mr-3">
                                <span>Number of days after date of hire</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="planEntry" value="months-after-hire" required class="radio-custom mr-3">
                                <span>Number of months after date of hire</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="planEntry" value="other" required class="radio-custom mr-3">
                                <span>Other</span>
                            </label>
                        </div>
                        
                        <!-- Conditional input fields - Side by side when applicable -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="field-group" id="waitingPeriodDays" style="display: none;">
                                <label class="field-label">Number of days:</label>
                                <input type="number" name="waitingPeriodDays" class="form-input w-full" min="1">
                            </div>
                            
                            <div class="field-group" id="waitingPeriodMonths" style="display: none;">
                                <label class="field-label">Number of months:</label>
                                <input type="number" name="waitingPeriodMonths" class="form-input w-full" min="1">
                            </div>
                        </div>
                        
                        <!-- Other field spans full width -->
                        <div class="field-group mt-6" id="planEntryOther" style="display: none;">
                            <label class="field-label">Other (please specify):</label>
                            <input type="text" name="planEntryOther" class="form-input w-full">
                        </div>
                    </div>
                    
                    <!-- FE Term Date Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-calendar-times contact-icon" aria-hidden="true"></i>EE Term Date <span class="required">*</span>
                        </h4>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="feTermDate" value="actual-term-date" required class="radio-custom mr-3">
                                <span>Actual term date</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="feTermDate" value="end-of-month" required class="radio-custom mr-3">
                                <span>End of month</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Reimbursements Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-money-check-alt contact-icon" aria-hidden="true"></i>Reimbursements <span class="required">*</span>
                        </h4>
                        <p class="text-gray-600 mb-6">Manual Reimbursements for claims paid via check and/or direct deposit will be issued:</p>
                        
                        <!-- Radio button for Daily option -->
                        <div class="mb-6">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="reimbursementFrequency" value="daily" required class="radio-custom mr-3">
                                <span>Daily</span>
                            </label>
                        </div>
                        
                        <!-- Weekly and Other options with inputs side by side -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="border border-gray-200 rounded-lg p-4">
                                <label class="flex items-center hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="reimbursementFrequency" value="weekly" required class="radio-custom mr-3">
                                    <span>Weekly (specify day):</span>
                                </label>
                                <input type="text" name="weeklyDay" class="form-input w-full mt-2" placeholder="Day of the week">
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg p-4">
                                <label class="flex items-center hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="reimbursementFrequency" value="other" required class="radio-custom mr-3">
                                    <span>Other (please specify):</span>
                                </label>
                                <input type="text" name="reimbursementOther" class="form-input w-full mt-2" placeholder="Specify frequency">
                            </div>
                        </div>
                        
                        <!-- Note spans full width -->
                        <div class="p-4 bg-yellow-50 border-l-4 border-yellow-400">
                            <p class="text-sm text-yellow-800">
                                <strong>Please note:</strong> The frequency defined above will only apply to manual claims. Debit card activity settles daily.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Participant Reimbursement Options Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-user-cog contact-icon" aria-hidden="true"></i>Participant Reimbursement Options
                        </h4>
                        <p class="text-gray-600 mb-6">Check all that apply:</p>
                        
                        <!-- Checkboxes in grid -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer" id="directDepositLabel">
                                <input type="checkbox" name="reimbursementOptions" value="direct-deposit" id="directDepositCheckbox" class="checkbox-custom mr-3" onchange="validateReimbursementOptions()">
                                <span>Direct Deposit</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer" id="checkLabel">
                                <input type="checkbox" name="reimbursementOptions" value="check" id="checkCheckbox" class="checkbox-custom mr-3" onchange="validateReimbursementOptions()">
                                <span>Check</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer" id="nueSynergyLabel">
                                <input type="checkbox" name="reimbursementOptions" value="nuesynergy-provided" id="nueSynergyCheckbox" class="checkbox-custom mr-3" onchange="validateReimbursementOptions()">
                                <span>NueSynergy Provided</span>
                            </label>
                        </div>
                        
                        <!-- Validation message for invalid combinations -->
                        <div id="reimbursementValidationMessage" class="p-4 bg-red-50 border-l-4 border-red-400 mb-4" style="display: none;">
                            <p class="text-sm text-red-800">
                                <strong>Invalid Selection:</strong> Please choose one of the allowed combinations: Direct Deposit only, Direct Deposit + Check, Direct Deposit + NueSynergy Provided, or Check + NueSynergy Provided.
                            </p>
                        </div>
                        
                        <!-- Conditional NueSynergy disclaimer -->
                        <div id="nueSynergyDisclaimer" class="p-4 bg-blue-50 border-l-4 border-blue-400" style="display: none;">
                            <p class="text-sm text-blue-800">
                                NueSynergy provides a reimbursement report; employer prepares/issues reimbursement checks.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Plan Contributions -->
                <div class="step-card p-8 hidden" id="step4">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator active">4</div>
                        <h3 class="text-3xl font-bold nue-primary-text">Plan Contributions</h3>
                    </div>
                    
                    <!-- Maximum Annual Contributions Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-dollar-sign contact-icon" aria-hidden="true"></i>Maximum Annual Contributions
                        </h4>
                        
                        <!-- Row 1: FSA Maximums -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group">
                                <label class="field-label">Dependent Care FSA Maximum</label>
                                <div class="flex items-center space-x-2">
                                    <span class="text-gray-700">$</span>
                                    <input type="number" name="dependentCareFSAMax" class="form-input flex-1" placeholder="7500" max="7500" min="0">
                                </div>
                                <p class="text-sm text-gray-500 mt-1">IRS maximum is $7,500 (2026)</p>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">Health Care FSA Maximum</label>
                                <div class="flex items-center space-x-2">
                                    <span class="text-gray-700">$</span>
                                    <input type="number" name="healthCareFSAMax" class="form-input flex-1" placeholder="3400" max="3400" min="0">
                                </div>
                                <p class="text-sm text-gray-500 mt-1">IRS maximum is $3,400 (2026)</p>
                            </div>
                        </div>
                        
                        <!-- Contribution Guidelines - Span 2 columns -->
                        <div class="p-4 bg-green-50 border-l-4 border-green-400">
                            <h5 class="font-semibold text-green-800 mb-2">Contribution Guidelines</h5>
                            <p class="text-sm text-green-700">
                                Set contribution limits based on your organization's benefits strategy and IRS maximums.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Employer Contributions Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-handshake contact-icon" aria-hidden="true"></i>Employer Contributions
                        </h4>
                        
                        <!-- Employer Contribution Question - Span 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Will the employer contribute to the Health Care FSA? <span class="required">*</span></label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="employerContribution" value="no" required class="radio-custom mr-3">
                                    <span>No</span>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="employerContribution" value="yes" required class="radio-custom mr-3">
                                    <span>Yes</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Employer Contribution Details - Conditional -->
                        <div id="employerContributionDetails" style="display: none;" class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <!-- Row 1: Pay period and Annual contributions -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div class="field-group">
                                    <label class="field-label">Each pay period contribution: $</label>
                                    <input type="number" name="employerContributionAmount" class="form-input w-full" step="0.01" min="0">
                                </div>
                                
                                <div class="field-group">
                                    <label class="field-label">Or annual upfront contribution: $</label>
                                    <input type="number" name="employerContributionAnnual" class="form-input w-full" step="0.01" min="0">
                                </div>
                            </div>
                            
                            <!-- Total contribution - Span 2 columns -->
                            <div class="field-group">
                                <label class="field-label">Total contribution per employee: $</label>
                                <input type="number" name="employeeContributionAmount" class="form-input w-full" step="0.01" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <!-- FSA Contribution Frequency Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-calendar-week contact-icon" aria-hidden="true"></i>FSA Contribution Frequency <span class="required">*</span>
                        </h4>
                        <p class="text-gray-600 mb-6">Select how often employee contributions will be deducted from payroll.</p>
                        
                        <!-- Frequency Radio Buttons - Span 2 columns -->
                        <div class="space-y-3 mb-6">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="contributionFrequency" value="weekly" required class="radio-custom mr-3" onchange="toggleFirstPayDateRequirement()">
                                <span>Weekly (52 periods)</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="contributionFrequency" value="bi-weekly" required class="radio-custom mr-3" onchange="toggleFirstPayDateRequirement()">
                                <span>Bi-weekly (26 periods)</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="contributionFrequency" value="semi-monthly" required class="radio-custom mr-3" onchange="toggleFirstPayDateRequirement()">
                                <span>Semi-Monthly (24 periods)</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="contributionFrequency" value="monthly" required class="radio-custom mr-3" onchange="toggleFirstPayDateRequirement()">
                                <span>Monthly (12 periods)</span>
                            </label>
                            
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="radio" name="contributionFrequency" value="other" required class="radio-custom mr-3" onchange="toggleFirstPayDateRequirement()">
                                <span>Other</span>
                            </label>
                        </div>
                        
                        <!-- Other frequency input - Span 2 columns -->
                        <div class="field-group" id="contributionFrequencyOther" style="display: none;">
                            <label class="field-label">Please specify other frequency:</label>
                            <input type="text" name="contributionFrequencyOtherText" class="form-input w-full" placeholder="Describe frequency">
                        </div>
                    </div>
                    
                    <!-- Payroll Deduction Settings Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-calculator contact-icon" aria-hidden="true"></i>Payroll Deduction Settings
                        </h4>
                        
                        <!-- Skip Deductions Setting - Only for Bi-weekly -->
                        <div class="field-group mb-6" id="skipDeductionsField">
                            <label class="field-label">First pay date after effective date:</label>
                            <input type="date" name="firstPayDate" id="firstPayDateInput" class="form-input w-full">
                            <p class="text-sm text-gray-600 mt-2">
                                This field is required when Bi-weekly (26 periods) contribution frequency is selected above.
                            </p>
                        </div>
                        
                        <!-- Skip Deductions Date - Only for Bi-weekly (Multiple dates supported) -->
                        <div class="field-group mb-6" id="skipDeductionsDateField" style="display: none;">
                            <label class="field-label">Pay periods to skip deductions (select up to 2 dates): <span class="required">*</span></label>
                            <p class="text-sm text-gray-600 mb-3">
                                If 26 pay periods and only 24 deductions, specify the pay dates when deductions should not be taken.
                            </p>
                            <div id="skipDatesContainer">
                                <div class="flex items-center gap-3 mb-3">
                                    <input type="date" name="skipDeductionDate1" class="form-input flex-1" id="skipDeductionDate1">
                                    <button type="button" class="btn-secondary py-2 px-4" onclick="removeSkipDate(1)" id="removeSkipDate1" style="display: none;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="button" id="addSkipDateBtn" class="btn-secondary mt-2" onclick="addSkipDate()">
                                <i class="fas fa-plus mr-2"></i>Add Another Skip Date
                            </button>
                        </div>
                        
                        <!-- Deduction Timing - Span 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Deductions are taken: <span class="required">*</span></label>
                            <div class="space-y-3 mt-3">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="deductionTiming" value="each-time-paid" required class="radio-custom mr-3">
                                    <span>Each time the employee is paid</span>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="deductionTiming" value="payroll-dates-without" required class="radio-custom mr-3">
                                    <span>Exclude specific payroll dates</span>
                                </label>
                            </div>
                            <input type="text" name="payrollDatesWithout" class="form-input w-full mt-3" placeholder="List payroll dates without deductions">
                        </div>
                        
                        <!-- Holiday Note - Span 2 columns -->
                        <div class="p-3 bg-yellow-50 border-l-4 border-yellow-400">
                            <p class="text-sm text-yellow-800">
                                <strong>Holiday Note:</strong> If pay date falls on weekend/holiday, deduction moves to previous or next business day.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Additional Information -->
                    <div class="mt-8 p-6 bg-blue-50 border-l-4 border-blue-400">
                        <p class="text-sm text-blue-800">
                            <strong>Automatic Calculation:</strong> If annual election is not equally divisible by pay periods, our system automatically adjusts final payroll contributions to meet the annual election amount.
                        </p>
                    </div>
                    
                    <!-- Commuter Benefits Contribution Limits -->
                    <div class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-bus contact-icon" aria-hidden="true"></i>Commuter Benefits Contribution Limits
                        </h4>
                        <p class="text-gray-600 mb-6">Set monthly contribution limits for qualified transportation benefits (2026 IRS limits).</p>
                        
                        <!-- Row: Transit and Parking Limits -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group">
                                <label class="field-label">Transit/Vanpool Reimbursement Maximum (per month)</label>
                                <div class="flex items-center space-x-2">
                                    <span class="text-gray-700">$</span>
                                    <input type="number" name="transitMax" class="form-input flex-1" placeholder="315" max="315" min="0">
                                </div>
                                <p class="text-sm text-gray-500 mt-1">IRS maximum is $315/month ($3,780 annually)</p>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">Parking Reimbursement Maximum (per month)</label>
                                <div class="flex items-center space-x-2">
                                    <span class="text-gray-700">$</span>
                                    <input type="number" name="parkingMax" class="form-input flex-1" placeholder="315" max="315" min="0">
                                </div>
                                <p class="text-sm text-gray-500 mt-1">IRS maximum is $315/month ($3,780 annually)</p>
                            </div>
                        </div>
                        
                        <!-- Information Note -->
                        <div class="p-4 bg-blue-50 border-l-4 border-blue-400">
                            <h5 class="font-semibold text-blue-800 mb-2">Commuter Benefits Guidelines</h5>
                            <p class="text-sm text-blue-700">
                                Commuter benefits are provided on a monthly basis. Participants can allocate funds toward mass transit passes, vanpool expenses, and/or qualified parking near their workplace or a mass transit facility.
                            </p>
                        </div>
                    </div>
                    
                    <!-- FSA Carryover Options -->
                    <div class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-piggy-bank contact-icon" aria-hidden="true"></i>FSA Carryover Options
                        </h4>
                        
                        <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg">
                            <h5 class="text-lg font-medium nue-primary-text mb-4">Carryover Policy</h5>
                            <p class="text-gray-600 mb-6">The FSA Carryover allows employees to carry over unused Health Care and/or Limited Purpose FSA funds to the following plan year. This option replaces the FSA Grace Period.</p>
                            
                            <div class="space-y-4">
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer bg-white">
                                    <input type="radio" name="carryover" value="yes-carryover" class="radio-custom mr-3" onchange="toggleCarryoverAmount()">
                                    <span>Yes, Enable Carryover</span>
                                </label>
                                
                                <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer bg-white">
                                    <input type="radio" name="carryover" value="no-carryover" class="radio-custom mr-3" onchange="toggleCarryoverAmount()">
                                    <span>No Carryover</span>
                                </label>
                            </div>
                            
                            <div class="mt-6" id="carryoverAmountField" style="display: none;">
                                <label class="field-label">Maximum carryover amount for unused Health Care/Limited Purpose FSA funds <span class="required">*</span></label>
                                <div class="flex items-center space-x-2 mt-2">
                                    <span class="text-gray-700">$</span>
                                    <input type="number" name="carryoverAmount" id="carryoverAmountInput" class="form-input flex-1" max="680" placeholder="680" min="0">
                                    <span class="text-sm text-gray-500">(IRS Maximum = $680 for 2026)</span>
                                </div>
                            </div>
                            
                            <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400">
                                <p class="text-sm text-yellow-800">
                                    <strong>Important:</strong> FSA Carryover is applicable to Health Care and Limited Purpose FSA accounts. Limited Purpose FSA will follow the same carryover limit as Healthcare FSA. Carryover is not permitted for Dependent Care FSA.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payroll Calendar Upload Section -->
                    <div class="contact-section mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-calendar-upload contact-icon" aria-hidden="true"></i>Payroll Calendar Upload <span class="required">*</span>
                        </h4>
                        <p class="text-gray-600 mb-6">Please upload your company's payroll calendar to ensure accurate contribution timing and deduction scheduling.</p>
                        
                        <!-- File Upload Field -->
                        <div class="field-group">
                            <label class="field-label">Upload Payroll Calendar <span class="required">*</span></label>
                            <div class="mt-2">
                                <input type="file" name="payrollCalendar" id="payrollCalendar" required 
                                       accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg" 
                                       class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100 border border-gray-300 rounded-lg p-3">
                                <p class="text-sm text-gray-500 mt-2">
                                    Accepted formats: PDF, Word documents, Excel files, or images (PNG, JPG). Maximum file size: 10MB.
                                </p>
                            </div>
                        </div>
                        
                        <!-- Upload Instructions -->
                        <div class="mt-6 p-4 bg-blue-50 border-l-4 border-blue-400">
                            <h5 class="font-semibold text-blue-800 mb-2">Payroll Calendar Requirements</h5>
                            <ul class="text-sm text-blue-700 space-y-1">
                                <li>• Include all pay dates for the plan year</li>
                                <li>• Clearly indicate any holiday or vacation pay periods</li>
                                <li>• Specify if any pay periods will be skipped for deductions</li>
                                <li>• Ensure dates align with your selected contribution frequency</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Administration Options -->
                <div class="step-card p-8 hidden" id="step5">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator active">5</div>
                        <h3 class="text-3xl font-bold nue-primary-text">Administration Options</h3>
                    </div>
                    
                    <!-- Claims Extension Grace Period Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-calendar-alt contact-icon" aria-hidden="true"></i>Claims Extension Grace Period
                        </h4>
                        
                        <!-- Grace Period Question - Span 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Does the employer want to offer a 2.5 month grace period? <span class="required">*</span></label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="gracePeriod" value="no" required class="radio-custom mr-3">
                                    <span>No</span>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="gracePeriod" value="yes" required class="radio-custom mr-3">
                                    <span>Yes</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Grace Period Note - Span 2 columns -->
                        <div class="p-4 bg-yellow-50 border-l-4 border-yellow-400">
                            <p class="text-sm text-yellow-800">
                                <strong>Note:</strong> Grace period will apply only to non-medical FSAs if the carryover is in place.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Run-Out Periods Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-hourglass-half contact-icon" aria-hidden="true"></i>Run-Out Periods
                        </h4>
                        
                        <!-- Guidelines - Span 2 columns -->
                        <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg mb-6">
                            <h5 class="font-semibold text-blue-800 mb-2">Run-Out Period Guidelines</h5>
                            <p class="text-sm text-blue-700 mb-2">
                                Run-out periods allow participants time to submit eligible claims after the plan year ends or employment terminates. Standard periods are 30-90 days.
                            </p>
                            <p class="text-sm text-blue-700">
                                <strong>Important:</strong> Run-out periods only apply to claims for expenses incurred during the plan year or employment period.
                            </p>
                        </div>
                        
                        <!-- Row 1: Plan Year and Termination Run-Out -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group">
                                <label class="field-label">Plan Year Run-Out Period <span class="required">*</span></label>
                                <p class="text-sm text-gray-600 mb-3">Days to allow claim submissions after plan year ends</p>
                                <select name="runOutPeriod" required class="form-input w-full">
                                    <option value="">Select period</option>
                                    <option value="30">30 Days</option>
                                    <option value="60">60 Days</option>
                                    <option value="90">90 Days</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">Termination Run-Out Period <span class="required">*</span></label>
                                <p class="text-sm text-gray-600 mb-2">Days to allow claim submissions after employee separation</p>
                                <p class="text-sm text-yellow-700 bg-yellow-50 p-2 rounded mb-3">
                                    <i class="fas fa-info-circle mr-1"></i><strong>Note:</strong> Only expenses incurred while actively enrolled are eligible for reimbursement during the run-out period
                                </p>
                                <select name="terminationRunOut" required class="form-input w-full">
                                    <option value="">Select period</option>
                                    <option value="30">30 Days</option>
                                    <option value="60">60 Days</option>
                                    <option value="90">90 Days</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Row 2: Other options when applicable -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="field-group" id="runOutPeriodOther" style="display: none;">
                                <label class="field-label">Plan Year Other (specify days):</label>
                                <input type="number" name="runOutPeriodOtherDays" class="form-input w-full" min="1">
                            </div>
                            
                            <div class="field-group" id="terminationRunOutOther" style="display: none;">
                                <label class="field-label">Termination Other (specify days):</label>
                                <input type="number" name="terminationRunOutOtherDays" class="form-input w-full" min="1">
                            </div>
                        </div>
                    </div>
                    <!-- Benefits Funding Periods Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-coins contact-icon" aria-hidden="true"></i>Benefits Funding Periods
                        </h4>
                        
                        <!-- Row 1: Pre-funded and Payroll Based Benefits -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                            <!-- Pre-funded Benefits -->
                            <div>
                                <h5 class="text-lg font-semibold nue-primary-text mb-4">Pre-funded Benefits</h5>
                                <p class="text-gray-600 mb-4">Health Care/Limited Purpose FSA</p>
                                
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="preFundedPeriod" value="30" class="radio-custom mr-3" onchange="togglePreFundedOther()">
                                        <span>30 Days</span>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="preFundedPeriod" value="60" class="radio-custom mr-3" onchange="togglePreFundedOther()">
                                        <span>60 Days</span>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="preFundedPeriod" value="90" class="radio-custom mr-3" onchange="togglePreFundedOther()">
                                        <span>90 Days</span>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="preFundedPeriod" value="other" class="radio-custom mr-3" onchange="togglePreFundedOther()">
                                        <span>Other</span>
                                    </label>
                                    
                                    <!-- Other period input - conditional -->
                                    <div class="field-group" id="preFundedOtherField" style="display: none;">
                                        <label class="field-label">Specify other pre-funding period:</label>
                                        <input type="text" name="preFundedOtherValue" class="form-input w-full" placeholder="e.g., 45 Days, 120 Days">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Payroll Based Benefits -->
                            <div>
                                <h5 class="text-lg font-semibold nue-primary-text mb-4">Payroll Based Benefits</h5>
                                <p class="text-gray-600 mb-4">Dependent Care/Adoption Assistance FSA</p>
                                
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="payrollBasedPeriod" value="30" class="radio-custom mr-3" onchange="togglePayrollBasedOther()">
                                        <span>30 Days</span>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="payrollBasedPeriod" value="60" class="radio-custom mr-3" onchange="togglePayrollBasedOther()">
                                        <span>60 Days</span>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="payrollBasedPeriod" value="90" class="radio-custom mr-3" onchange="togglePayrollBasedOther()">
                                        <span>90 Days</span>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="payrollBasedPeriod" value="other" class="radio-custom mr-3" onchange="togglePayrollBasedOther()">
                                        <span>Other</span>
                                    </label>
                                    
                                    <!-- Other period input - conditional -->
                                    <div class="field-group" id="payrollBasedOtherField" style="display: none;">
                                        <label class="field-label">Specify other payroll-based period:</label>
                                        <input type="text" name="payrollBasedOtherValue" class="form-input w-full" placeholder="e.g., 45 Days, 120 Days">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Debit Card Management Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-credit-card contact-icon" aria-hidden="true"></i>Debit Card Management
                        </h4>
                        
                        <!-- Row 1: Smart Debit Card and Unsubstantiated Claims Questions -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                            <!-- NueSynergy Smart Debit Card -->
                            <div class="field-group">
                                <h5 class="text-lg font-semibold nue-primary-text mb-4">NueSynergy Smart Debit Card</h5>
                                <label class="field-label">Offer the NueSynergy smart debit card? <span class="required">*</span></label>
                                <div class="space-y-3 mt-4">
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="smartDebitCard" value="no" required class="radio-custom mr-3">
                                        <span>No</span>
                                    </label>
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="smartDebitCard" value="yes" required class="radio-custom mr-3">
                                        <span>Yes</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Unsubstantiated Claims -->
                            <div class="field-group">
                                <h5 class="text-lg font-semibold nue-primary-text mb-4">Unsubstantiated Claims</h5>
                                <label class="field-label">Allow NueSynergy to deactivate debit cards for unsubstantiated claims? <span class="required">*</span></label>
                                <div class="space-y-3 mt-4">
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="denyUnsubstantiated" value="no" required class="radio-custom mr-3">
                                        <span>No</span>
                                    </label>
                                    <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                        <input type="radio" name="denyUnsubstantiated" value="yes" required class="radio-custom mr-3">
                                        <span>Yes</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Row 2: Conditional Options -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Debit Card Options -->
                            <div id="smartDebitCardOptions" style="display: none;" class="p-4 bg-green-50 border border-green-200 rounded-lg">
                                <label class="field-label mb-3 block">Debit card options: <span class="required">*</span></label>
                                <div class="space-y-3">
                                    <label class="flex items-center p-2 border border-gray-200 rounded hover:border-green-400 cursor-pointer bg-white">
                                        <input type="radio" name="debitCardOptions" value="auto-card" required class="radio-custom mr-3">
                                        <span>Auto-card (automatically issue to all participants)</span>
                                    </label>
                                    <label class="flex items-center p-2 border border-gray-200 rounded hover:border-green-400 cursor-pointer bg-white">
                                        <input type="radio" name="debitCardOptions" value="have-participant-elect" required class="radio-custom mr-3">
                                        <span>Participant elects card during enrollment</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Unsubstantiated Claims Options -->
                            <div id="denyUnsubstantiatedOptions" style="display: none;" class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <div class="field-group mb-4">
                                    <label class="field-label">Days before deactivation:</label>
                                    <select name="deactivationDays" class="form-input w-full">
                                        <option value="">Select days</option>
                                        <option value="30">30 Days</option>
                                        <option value="60">60 Days</option>
                                        <option value="90">90 Days</option>
                                    </select>
                                </div>
                                
                                <div class="p-3 bg-blue-50 border-l-4 border-blue-400">
                                    <p class="text-sm text-blue-800">
                                        Participants with email addresses receive notifications about required substantiation. Cards can be reactivated once claims are properly substantiated.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Claims Manager Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-file-medical contact-icon" aria-hidden="true"></i>Claims Manager
                        </h4>
                        
                        <!-- Claims Manager Question - Span 2 columns -->
                        <div class="field-group mb-6">
                            <label class="field-label">Provide eClaims Manager to employees? <span class="required">*</span></label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="claimsManager" value="no" required class="radio-custom mr-3">
                                    <span>No</span>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                    <input type="radio" name="claimsManager" value="yes" required class="radio-custom mr-3">
                                    <span>Yes</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Benefits and Note sections - Side by side -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="p-4 bg-gray-50 border-l-4 border-gray-400 rounded-r-lg">
                                <h5 class="font-semibold text-gray-800 mb-2">eClaims Manager Benefits</h5>
                                <p class="text-sm text-gray-700">
                                    Provides employees with health, dental, and vision insurance claims data on their member portal, enabling automatic substantiation of debit card claims.
                                </p>
                            </div>
                            
                            <div class="p-3 bg-yellow-50 border-l-4 border-yellow-400">
                                <p class="text-sm text-yellow-800">
                                    <strong>Note:</strong> Without debit card substantiation, notification is delayed 30 days to allow claims substantiation against eClaims Manager.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Plan Amendment/Changes Section -->
                    <div class="contact-section mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                            <i class="fas fa-edit contact-icon" aria-hidden="true"></i>Plan Amendment/Changes Required
                        </h4>
                        
                        <!-- Checkboxes in 2-3 columns for better space usage -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6">
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="checkbox" name="planChanges" value="plan-eligibility" class="checkbox-custom mr-3">
                                <span>Plan Eligibility Requirements</span>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="checkbox" name="planChanges" value="short-plan-year" class="checkbox-custom mr-3">
                                <span>Short Plan Year</span>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="checkbox" name="planChanges" value="fsa-carryover" class="checkbox-custom mr-3">
                                <span>FSA Carryover Elections</span>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="checkbox" name="planChanges" value="annual-contribution" class="checkbox-custom mr-3">
                                <span>Annual Contribution Limit</span>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-green-400 cursor-pointer">
                                <input type="checkbox" name="planChanges" value="additional-plans" class="checkbox-custom mr-3">
                                <span>Additional Plans Offered</span>
                            </label>
                        </div>
                        
                        <!-- Other changes field - Span 2 columns -->
                        <div class="field-group">
                            <label class="field-label">Other changes:</label>
                            <input type="text" name="planChangesOther" class="form-input w-full" placeholder="Specify other plan changes">
                        </div>
                    </div>
                </div>

                <!-- Step 6: Authorization -->
                <div class="step-card p-8 hidden" id="step6">
                    <div class="flex items-center mb-8">
                        <div class="step-indicator active">6</div>
                        <h3 class="text-3xl font-bold nue-primary-text">Authorized Signature</h3>
                    </div>
                    
                    <div class="space-y-8">
                        
                        <!-- Signature Section -->
                        <div class="contact-section p-6 bg-gray-50 rounded-lg border border-gray-200">
                            <h4 class="contact-header text-xl font-semibold nue-primary-text mb-6">
                                <i class="fas fa-signature contact-icon" aria-hidden="true"></i>Authorization
                            </h4>
                            <p class="text-gray-600 mb-6">
                                By signing below, the authorized representative acknowledges that they have reviewed and agree to the terms of this FSA Administration Adoption Agreement.
                            </p>
                            
                            <!-- Authorization Details -->
                            <div class="space-y-6">
                                    <div class="field-group">
                                        <label class="field-label">Date <span class="required">*</span></label>
                                        <input type="date" name="signatureDate" required class="form-input w-full" id="signatureDate">
                                    </div>
                                    
                                    <!-- Print Name and Title side by side -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div class="field-group">
                                            <label class="field-label">Print Name <span class="required">*</span></label>
                                            <input type="text" name="printName" required class="form-input w-full">
                                        </div>
                                        
                                        <div class="field-group">
                                            <label class="field-label">Title <span class="required">*</span></label>
                                            <input type="text" name="signatureTitle" required class="form-input w-full">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Company Information -->
                        <div class="mt-8 p-6 bg-gray-50 rounded-lg text-center">
                            <div class="mb-4">
                                <h5 class="text-2xl font-bold nue-primary-text">NueSynergy</h5>
                                <p class="nue-secondary-text font-medium">Administrative Services</p>
                            </div>
                            
                            <div class="text-sm text-gray-600 space-y-1">
                                <p>(855) 653-4581 | (855) 650-7238 Fax Free | (855) 650-7238 Fax</p>
                                <p>4801 College Blvd, Suite 290, Leawood, Kansas 66211 | Implementation@NueSynergy.com</p>
                                <p class="font-medium nue-primary-text">www.NueSynergy.com</p>
                            </div>
                        </div>
                        
                        <!-- Agreement Delivery Information -->
                        <div class="mt-8 p-6 bg-blue-50 border-l-4 border-blue-400 rounded-lg">
                            <h5 class="flex items-center text-lg font-semibold text-blue-900 mb-4">
                                <i class="fas fa-envelope-open-text mr-3 text-2xl" aria-hidden="true"></i>
                                Upon Submission, You Will Receive:
                            </h5>
                            <ul class="space-y-2 text-sm text-blue-800">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle mr-2 mt-1 text-green-600"></i>
                                    <span>An immediate downloadable PDF copy of your completed agreement</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle mr-2 mt-1 text-green-600"></i>
                                    <span>A confirmation email with attached copy sent to your primary contact email</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle mr-2 mt-1 text-green-600"></i>
                                    <span>Access to view/download from your NueSynergy portal within 24 hours</span>
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Final Confirmation -->
                        <div class="mt-8 p-6 bg-green-50 border border-green-200 rounded-lg">
                            <div class="flex items-center">
                                <input type="checkbox" name="finalConfirmation" required class="checkbox-custom mr-4">
                                <label class="text-gray-700">
                                    I confirm that all information provided in this FSA Administration Adoption Agreement is accurate and complete. I understand that this agreement will govern the administration of our organization's Flexible Spending Account plan.
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
                    <button type="button" id="prevBtn" class="btn-secondary hidden">
                        ← Previous Step
                    </button>
                    
                    <div class="flex space-x-4 ml-auto">
                        <button type="button" id="saveProgressBtn" class="btn-secondary">
                            💾 Save Progress
                        </button>
                        
                        <button type="button" id="nextBtn" class="btn-primary">
                            Continue →
                        </button>
                        
                        <button type="submit" id="submitBtn" class="btn-primary hidden">
                            Complete Agreement
                        </button>
                    </div>
                </div>
                
                </form>
            </main>
        </div>
    </div>

    <script>
        // Modern JavaScript with proper error handling and constants
        'use strict';
        
        // Form state management - using const where possible
        const TOTAL_STEPS = 6;
        let currentStep = 1;
        let signaturePad;
        let formData = {};
        
        // DOM element references - cached for performance
        const elements = {
            form: null,
            progressBar: null,
            progressText: null,
            statusMessage: null,
            errorMessage: null,
            nextBtn: null,
            prevBtn: null,
            submitBtn: null,
            saveProgressBtn: null,
            signatureCanvas: null,
            clearSignatureBtn: null,
            signatureDateInput: null
        };

        // Initialize form with error handling
        document.addEventListener('DOMContentLoaded', function() {
            try {
                cacheElements();
                initializeSignaturePad();
                loadSavedProgress();
                updateDisplay();
                setupEventListeners();
                setTodaysDate();
                announceToScreenReader('FSA Administration form loaded and ready');
            } catch (error) {
                console.error('Error initializing form:', error);
                announceError('Form initialization failed. Please refresh the page.');
            }
        });
        
        // Cache DOM elements for better performance
        function cacheElements() {
            elements.form = document.getElementById('fsaForm');
            elements.progressBar = document.getElementById('progressBar');
            elements.progressText = document.getElementById('progressText');
            elements.statusMessage = document.getElementById('status-message');
            elements.errorMessage = document.getElementById('error-message');
            elements.nextBtn = document.getElementById('nextBtn');
            elements.prevBtn = document.getElementById('prevBtn');
            elements.submitBtn = document.getElementById('submitBtn');
            elements.saveProgressBtn = document.getElementById('saveProgressBtn');
            elements.signatureCanvas = document.getElementById('signaturePad');
            elements.clearSignatureBtn = document.getElementById('clearSignature');
            elements.signatureDateInput = document.getElementById('signatureDate');
        }
        
        // Accessibility helper functions
        function announceToScreenReader(message) {
            if (elements.statusMessage) {
                elements.statusMessage.textContent = message;
            }
        }
        
        function announceError(message) {
            if (elements.errorMessage) {
                elements.errorMessage.textContent = message;
            }
        }

        // Toggle Short Plan Year conditional fields
        function toggleShortPlanYearFields() {
            const shortPlanYearRadios = document.querySelectorAll('input[name="shortPlanYear"]');
            const detailsDiv = document.getElementById('shortPlanYearDetails');
            
            if (!detailsDiv) return;
            
            let isYesSelected = false;
            shortPlanYearRadios.forEach(radio => {
                if (radio.checked && radio.value === 'yes') {
                    isYesSelected = true;
                }
            });
            
            if (isYesSelected) {
                detailsDiv.style.display = 'block';
            } else {
                detailsDiv.style.display = 'none';
            }
        }

        // Toggle Plan Number field and upload section for existing plan document
        function togglePlanNumberField() {
            const planDocumentRadios = document.querySelectorAll('input[name="planDocument"]');
            const planNumberDiv = document.getElementById('planNumberField');
            const uploadDiv = document.getElementById('existingPlanUploadField');
            const uploadInput = document.getElementById('existingPlanDocuments');
            
            if (!planNumberDiv) return;
            
            let isExistingSelected = false;
            planDocumentRadios.forEach(radio => {
                if (radio.checked && radio.value === 'existing') {
                    isExistingSelected = true;
                }
            });
            
            if (isExistingSelected) {
                planNumberDiv.style.display = 'block';
                if (uploadDiv) {
                    uploadDiv.style.display = 'block';
                }
                // Make upload required when existing plan is selected
                if (uploadInput) {
                    uploadInput.required = true;
                }
                announceToScreenReader('Plan number and document upload fields are now visible and required');
            } else {
                planNumberDiv.style.display = 'none';
                if (uploadDiv) {
                    uploadDiv.style.display = 'none';
                }
                // Remove upload requirement when existing plan is not selected
                if (uploadInput) {
                    uploadInput.required = false;
                    uploadInput.value = ''; // Clear any previously selected file
                }
                announceToScreenReader('Plan number and document upload fields are now hidden');
            }
        }

        // Toggle NueSynergy disclaimer for reimbursement options
        function toggleNueSynergyDisclaimer() {
            const reimbursementCheckboxes = document.querySelectorAll('input[name="reimbursementOptions"]');
            const disclaimerDiv = document.getElementById('nueSynergyDisclaimer');
            
            if (!disclaimerDiv) return;
            
            let isNueSynergySelected = false;
            reimbursementCheckboxes.forEach(checkbox => {
                if (checkbox.checked && checkbox.value === 'nuesynergy-provided') {
                    isNueSynergySelected = true;
                }
            });
            
            if (isNueSynergySelected) {
                disclaimerDiv.style.display = 'block';
            } else {
                disclaimerDiv.style.display = 'none';
            }
        }

        // Toggle pre-funded benefits other field
        function togglePreFundedOther() {
            try {
                const otherRadio = document.querySelector('input[name="preFundedPeriod"][value="other"]');
                const otherField = document.getElementById('preFundedOtherField');
                const otherInput = document.querySelector('input[name="preFundedOtherValue"]');
                
                if (!otherField || !otherInput) {
                    console.error('Pre-funded other field elements not found');
                    return;
                }
                
                if (otherRadio && otherRadio.checked) {
                    otherField.style.display = 'block';
                    otherInput.required = true;
                    announceToScreenReader('Pre-funded benefits other period field is now visible and required');
                } else {
                    otherField.style.display = 'none';
                    otherInput.required = false;
                    otherInput.value = '';
                    announceToScreenReader('Pre-funded benefits other period field is now hidden');
                }
            } catch (error) {
                console.error('Error toggling pre-funded other field:', error);
                announceError('Error updating pre-funded benefits other field');
            }
        }

        // Toggle payroll based benefits other field
        function togglePayrollBasedOther() {
            try {
                const otherRadio = document.querySelector('input[name="payrollBasedPeriod"][value="other"]');
                const otherField = document.getElementById('payrollBasedOtherField');
                const otherInput = document.querySelector('input[name="payrollBasedOtherValue"]');
                
                if (!otherField || !otherInput) {
                    console.error('Payroll based other field elements not found');
                    return;
                }
                
                if (otherRadio && otherRadio.checked) {
                    otherField.style.display = 'block';
                    otherInput.required = true;
                    announceToScreenReader('Payroll based benefits other period field is now visible and required');
                } else {
                    otherField.style.display = 'none';
                    otherInput.required = false;
                    otherInput.value = '';
                    announceToScreenReader('Payroll based benefits other period field is now hidden');
                }
            } catch (error) {
                console.error('Error toggling payroll based other field:', error);
                announceError('Error updating payroll based benefits other field');
            }
        }

        // Toggle carryover amount field visibility
        function toggleCarryoverAmount() {
            try {
                const carryoverRadios = document.querySelectorAll('input[name="carryover"]');
                const carryoverAmountField = document.getElementById('carryoverAmountField');
                const carryoverAmountInput = document.getElementById('carryoverAmountInput');
                
                if (!carryoverAmountField || !carryoverAmountInput) {
                    console.error('Carryover amount elements not found');
                    return;
                }
                
                let isCarryoverEnabled = false;
                carryoverRadios.forEach(radio => {
                    if (radio.checked && radio.value === 'yes-carryover') {
                        isCarryoverEnabled = true;
                    }
                });
                
                if (isCarryoverEnabled) {
                    // Show field and make it required
                    carryoverAmountField.style.display = 'block';
                    carryoverAmountInput.required = true;
                    announceToScreenReader('Maximum carryover amount field is now visible and required');
                } else {
                    // Hide field and remove requirement
                    carryoverAmountField.style.display = 'none';
                    carryoverAmountInput.required = false;
                    carryoverAmountInput.value = ''; // Clear any previously entered value
                    announceToScreenReader('Maximum carryover amount field is now hidden');
                }
            } catch (error) {
                console.error('Error toggling carryover amount field:', error);
                announceError('Error updating carryover amount field visibility');
            }
        }

        // Toggle first pay date field requirement based on contribution frequency
        function toggleFirstPayDateRequirement() {
            try {
                const contributionFrequencyRadios = document.querySelectorAll('input[name="contributionFrequency"]');
                const firstPayDateInput = document.getElementById('firstPayDateInput');
                const skipDeductionsField = document.getElementById('skipDeductionsField');
                const skipDeductionDateInput = document.getElementById('skipDeductionDateInput');
                const skipDeductionsDateField = document.getElementById('skipDeductionsDateField');
                
                if (!firstPayDateInput || !skipDeductionsField) {
                    console.error('First pay date elements not found');
                    return;
                }
                
                let isBiWeeklySelected = false;
                contributionFrequencyRadios.forEach(radio => {
                    if (radio.checked && radio.value === 'bi-weekly') {
                        isBiWeeklySelected = true;
                    }
                });
                
                if (isBiWeeklySelected) {
                    // Make fields required and visible
                    firstPayDateInput.required = true;
                    skipDeductionsField.style.display = 'block';
                    
                    if (skipDeductionDateInput && skipDeductionsDateField) {
                        skipDeductionDateInput.required = true;
                        skipDeductionsDateField.style.display = 'block';
                    }
                    
                    // Add visual indicator for required field
                    const label = skipDeductionsField.querySelector('.field-label');
                    if (label && !label.innerHTML.includes('<span class="required">*</span>')) {
                        label.innerHTML = 'First pay date after effective date: <span class="required">*</span>';
                    }
                    
                    announceToScreenReader('Pay date fields are now required for bi-weekly contribution frequency');
                } else {
                    // Make fields not required but keep visible
                    firstPayDateInput.required = false;
                    skipDeductionsField.style.display = 'block';
                    
                    if (skipDeductionDateInput && skipDeductionsDateField) {
                        skipDeductionDateInput.required = false;
                        skipDeductionsDateField.style.display = 'none';
                        skipDeductionDateInput.value = ''; // Clear the field when hidden
                    }
                    
                    // Remove visual indicator for required field
                    const label = skipDeductionsField.querySelector('.field-label');
                    if (label) {
                        label.innerHTML = 'First pay date after effective date:';
                    }
                    
                    announceToScreenReader('Pay date fields are now optional');
                }
            } catch (error) {
                console.error('Error toggling first pay date requirement:', error);
                announceError('Error updating first pay date field requirement');
            }
        }

        // Validate participant reimbursement options combinations
        function validateReimbursementOptions() {
            try {
                const directDeposit = document.getElementById('directDepositCheckbox');
                const check = document.getElementById('checkCheckbox');
                const nueSynergy = document.getElementById('nueSynergyCheckbox');
                const validationMessage = document.getElementById('reimbursementValidationMessage');
                
                if (!directDeposit || !check || !nueSynergy || !validationMessage) {
                    console.error('Reimbursement option elements not found');
                    return;
                }
                
                // Get current selection state
                const directDepositChecked = directDeposit.checked;
                const checkChecked = check.checked;
                const nueSynergyChecked = nueSynergy.checked;
                
                // Define valid combinations
                const validCombinations = [
                    // Direct Deposit only
                    { directDeposit: true, check: false, nueSynergy: false },
                    // Direct Deposit + Check
                    { directDeposit: true, check: true, nueSynergy: false },
                    // Direct Deposit + NueSynergy Provided
                    { directDeposit: true, check: false, nueSynergy: true },
                    // Check + NueSynergy Provided
                    { directDeposit: false, check: true, nueSynergy: true }
                ];
                
                // Check if current selection matches any valid combination
                const currentSelection = {
                    directDeposit: directDepositChecked,
                    check: checkChecked,
                    nueSynergy: nueSynergyChecked
                };
                
                const isValidCombination = validCombinations.some(combo => 
                    combo.directDeposit === currentSelection.directDeposit &&
                    combo.check === currentSelection.check &&
                    combo.nueSynergy === currentSelection.nueSynergy
                );
                
                // Handle validation result
                if (isValidCombination || (!directDepositChecked && !checkChecked && !nueSynergyChecked)) {
                    // Valid combination or no selection - hide validation message
                    validationMessage.style.display = 'none';
                    
                    // Remove error styling from labels
                    document.getElementById('directDepositLabel').classList.remove('border-red-400', 'bg-red-50');
                    document.getElementById('checkLabel').classList.remove('border-red-400', 'bg-red-50');
                    document.getElementById('nueSynergyLabel').classList.remove('border-red-400', 'bg-red-50');
                    
                    announceToScreenReader('Valid reimbursement option selection');
                } else {
                    // Invalid combination - show validation message and highlight errors
                    validationMessage.style.display = 'block';
                    
                    // Add error styling to labels
                    document.getElementById('directDepositLabel').classList.add('border-red-400', 'bg-red-50');
                    document.getElementById('checkLabel').classList.add('border-red-400', 'bg-red-50');
                    document.getElementById('nueSynergyLabel').classList.add('border-red-400', 'bg-red-50');
                    
                    announceError('Invalid reimbursement option combination selected. Please choose a valid combination.');
                }
                
                // Always call the NueSynergy disclaimer toggle
                toggleNueSynergyDisclaimer();
                
            } catch (error) {
                console.error('Error validating reimbursement options:', error);
                announceError('Error validating reimbursement options');
            }
        }

        // Copy primary contact information to other contact sections
        function copyFromPrimary(targetSection) {
            try {
                // Get primary contact field values
                const primaryName = document.getElementById('primaryContactName').value;
                const primaryTitle = document.getElementById('primaryContactTitle').value;
                const primaryPhone = document.getElementById('primaryContactPhone').value;
                const primaryEmail = document.getElementById('primaryContactEmail').value;
                
                // Check if checkbox is checked
                const checkbox = document.getElementById(`copyTo${targetSection.charAt(0).toUpperCase() + targetSection.slice(1)}`);
                
                if (checkbox && checkbox.checked) {
                    // Copy values to target section
                    const targetName = document.getElementById(`${targetSection}ContactName`);
                    const targetTitle = document.getElementById(`${targetSection}ContactTitle`);
                    const targetPhone = document.getElementById(`${targetSection}ContactPhone`);
                    const targetEmail = document.getElementById(`${targetSection}ContactEmail`);
                    
                    if (targetName) targetName.value = primaryName;
                    if (targetTitle) targetTitle.value = primaryTitle;
                    if (targetPhone) targetPhone.value = primaryPhone;
                    if (targetEmail) targetEmail.value = primaryEmail;
                    
                    // Announce to screen reader
                    announceToScreenReader(`Primary contact information copied to ${targetSection} contact section`);
                } else {
                    // Clear target section if checkbox is unchecked
                    const targetName = document.getElementById(`${targetSection}ContactName`);
                    const targetTitle = document.getElementById(`${targetSection}ContactTitle`);
                    const targetPhone = document.getElementById(`${targetSection}ContactPhone`);
                    const targetEmail = document.getElementById(`${targetSection}ContactEmail`);
                    
                    if (targetName) targetName.value = '';
                    if (targetTitle) targetTitle.value = '';
                    if (targetPhone) targetPhone.value = '';
                    if (targetEmail) targetEmail.value = '';
                    
                    // Announce to screen reader
                    announceToScreenReader(`${targetSection} contact section cleared`);
                }
            } catch (error) {
                console.error(`Error copying primary contact to ${targetSection}:`, error);
                announceError(`Failed to copy primary contact information to ${targetSection} section`);
            }
        }

        function initializeSignaturePad() {
            try {
                const canvas = elements.signatureCanvas;
                if (!canvas) {
                    throw new Error('Signature canvas not found');
                }
                
                // Ensure SignaturePad library is loaded
                if (typeof SignaturePad === 'undefined') {
                    throw new Error('SignaturePad library not loaded');
                }
                
                // Clear any existing signature pad
                if (signaturePad) {
                    signaturePad.off();
                }
                
                // Initialize with better options
                signaturePad = new SignaturePad(canvas, {
                    backgroundColor: '#ffffff',
                    penColor: '#1E4E6B',
                    minWidth: 1,
                    maxWidth: 3,
                    throttle: 16,
                    minDistance: 5
                });
                
                // Set canvas size properly
                const resizeCanvas = () => {
                    try {
                        const rect = canvas.getBoundingClientRect();
                        const ratio = Math.max(window.devicePixelRatio || 1, 1);
                        
                        // Save signature data before resize
                        const signatureData = signaturePad.toData();
                        
                        // Set canvas dimensions
                        canvas.width = rect.width * ratio;
                        canvas.height = rect.height * ratio;
                        
                        // Set CSS size
                        canvas.style.width = rect.width + 'px';
                        canvas.style.height = rect.height + 'px';
                        
                        // Scale context
                        const ctx = canvas.getContext('2d');
                        ctx.scale(ratio, ratio);
                        
                        // Restore signature data
                        signaturePad.clear();
                        if (signatureData && signatureData.length > 0) {
                            signaturePad.fromData(signatureData);
                        }
                    } catch (error) {
                        console.error('Error resizing signature canvas:', error);
                    }
                };
                
                // Initial resize
                setTimeout(resizeCanvas, 100);
                
                // Add resize listener
                window.addEventListener('resize', resizeCanvas);
                
                // Add event listeners for signature pad
                signaturePad.addEventListener('beginStroke', () => {
                    canvas.classList.add('active');
                });
                
                signaturePad.addEventListener('endStroke', () => {
                    canvas.classList.remove('active');
                    // Auto-save when signature changes
                    if (typeof saveCurrentStepData === 'function') {
                        saveCurrentStepData();
                    }
                });
                
                console.log('Signature pad initialized successfully');
            } catch (error) {
                console.error('Error initializing signature pad:', error);
                announceError('Signature pad failed to initialize. Please refresh the page and try again.');
            }
        }

        function setTodaysDate() {
            try {
                const today = new Date().toISOString().split('T')[0];
                if (elements.signatureDateInput) {
                    elements.signatureDateInput.value = today;
                }
            } catch (error) {
                console.error('Error setting today\'s date:', error);
            }
        }

        function setupEventListeners() {
            try {
                // Navigation buttons with null checks
                if (elements.nextBtn) {
                    elements.nextBtn.addEventListener('click', nextStep);
                }
                if (elements.prevBtn) {
                    elements.prevBtn.addEventListener('click', prevStep);
                }
                if (elements.saveProgressBtn) {
                    elements.saveProgressBtn.addEventListener('click', saveProgress);
                }
                
                // Form submission
                if (elements.form) {
                    elements.form.addEventListener('submit', submitForm);
                }
                
                // Signature pad with modern arrow function
                if (elements.clearSignatureBtn && signaturePad) {
                    elements.clearSignatureBtn.addEventListener('click', () => {
                        try {
                            signaturePad.clear();
                            announceToScreenReader('Signature cleared');
                        } catch (error) {
                            console.error('Error clearing signature:', error);
                        }
                    });
                }
                
                // Dynamic field visibility
                setupConditionalFields();
                
                // Add administrator functionality
                const addAdminBtn = document.getElementById('addAdministrator');
                if (addAdminBtn) {
                    addAdminBtn.addEventListener('click', addAdministratorRow);
                }
            } catch (error) {
                console.error('Error setting up event listeners:', error);
                announceError('Failed to setup form interactions');
            }
        }

        function setupConditionalFields() {
            // Plan status renewal info
            document.querySelectorAll('input[name="planStatus"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const renewalInfo = document.getElementById('renewalInfo');
                    renewalInfo.style.display = this.value === 'renewal' ? 'block' : 'none';
                });
            });
            
            // Plan entry waiting periods
            document.querySelectorAll('input[name="planEntry"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('waitingPeriodDays').style.display = 'none';
                    document.getElementById('waitingPeriodMonths').style.display = 'none';
                    document.getElementById('planEntryOther').style.display = 'none';
                    
                    if (this.value === 'days-after-hire') {
                        document.getElementById('waitingPeriodDays').style.display = 'block';
                    } else if (this.value === 'months-after-hire') {
                        document.getElementById('waitingPeriodMonths').style.display = 'block';
                    } else if (this.value === 'other') {
                        document.getElementById('planEntryOther').style.display = 'block';
                    }
                });
            });
            
            // Employer contribution details
            document.querySelectorAll('input[name="employerContribution"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const details = document.getElementById('employerContributionDetails');
                    details.style.display = this.value === 'yes' ? 'block' : 'none';
                });
            });
            
            // Contribution frequency other
            document.querySelectorAll('input[name="contributionFrequency"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const other = document.getElementById('contributionFrequencyOther');
                    other.style.display = this.value === 'other' ? 'block' : 'none';
                });
            });
            
            // Run-out period other options
            document.querySelector('select[name="runOutPeriod"]').addEventListener('change', function() {
                const other = document.getElementById('runOutPeriodOther');
                other.style.display = this.value === 'other' ? 'block' : 'none';
            });
            
            document.querySelector('select[name="terminationRunOut"]').addEventListener('change', function() {
                const other = document.getElementById('terminationRunOutOther');
                other.style.display = this.value === 'other' ? 'block' : 'none';
            });
            
            // Smart debit card options
            document.querySelectorAll('input[name="smartDebitCard"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const options = document.getElementById('smartDebitCardOptions');
                    options.style.display = this.value === 'yes' ? 'block' : 'none';
                });
            });
            
            // Deny unsubstantiated options
            document.querySelectorAll('input[name="denyUnsubstantiated"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const options = document.getElementById('denyUnsubstantiatedOptions');
                    options.style.display = this.value === 'yes' ? 'block' : 'none';
                });
            });
        }

        function addAdministratorRow() {
            const table = document.getElementById('administratorTable');
            const rowCount = table.rows.length + 1;
            const newRow = table.insertRow();
            
            newRow.innerHTML = `
                <td class="border border-gray-300 p-2">
                    <input type="text" name="adminName${rowCount}" class="form-input w-full">
                </td>
                <td class="border border-gray-300 p-2">
                    <input type="tel" name="adminPhone${rowCount}" class="form-input w-full">
                </td>
                <td class="border border-gray-300 p-2">
                    <input type="email" name="adminEmail${rowCount}" class="form-input w-full">
                </td>
            `;
        }

        // Skip Date Management Functions
        let skipDateCount = 1;
        const MAX_SKIP_DATES = 2;

        function addSkipDate() {
            if (skipDateCount >= MAX_SKIP_DATES) {
                announceToScreenReader('Maximum of 2 skip dates reached');
                return;
            }
            
            skipDateCount++;
            const container = document.getElementById('skipDatesContainer');
            const addButton = document.getElementById('addSkipDateBtn');
            
            const newDateRow = document.createElement('div');
            newDateRow.className = 'flex items-center gap-3 mb-3';
            newDateRow.id = `skipDateRow${skipDateCount}`;
            newDateRow.innerHTML = `
                <input type="date" name="skipDeductionDate${skipDateCount}" class="form-input flex-1" id="skipDeductionDate${skipDateCount}">
                <button type="button" class="btn-secondary py-2 px-4" onclick="removeSkipDate(${skipDateCount})" id="removeSkipDate${skipDateCount}">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(newDateRow);
            
            // Show remove button for first date when second is added
            const firstRemoveBtn = document.getElementById('removeSkipDate1');
            if (firstRemoveBtn) {
                firstRemoveBtn.style.display = 'block';
            }
            
            // Hide add button if max reached
            if (skipDateCount >= MAX_SKIP_DATES) {
                addButton.style.display = 'none';
            }
            
            announceToScreenReader(`Skip date field ${skipDateCount} added`);
        }

        function removeSkipDate(dateNumber) {
            const row = document.getElementById(`skipDateRow${dateNumber}`);
            if (row) {
                row.remove();
                skipDateCount--;
                
                // Show add button if under max
                const addButton = document.getElementById('addSkipDateBtn');
                if (addButton && skipDateCount < MAX_SKIP_DATES) {
                    addButton.style.display = 'block';
                }
                
                // Hide remove button on first date if only one date left
                if (skipDateCount === 1) {
                    const firstRemoveBtn = document.getElementById('removeSkipDate1');
                    if (firstRemoveBtn) {
                        firstRemoveBtn.style.display = 'none';
                    }
                }
                
                announceToScreenReader(`Skip date field ${dateNumber} removed`);
            }
        }

        function updateProgress() {
            try {
                const progress = (currentStep / TOTAL_STEPS) * 100;
                
                if (elements.progressBar) {
                    elements.progressBar.style.width = `${progress}%`;
                }
                
                if (elements.progressText) {
                    elements.progressText.textContent = `Step ${currentStep}`;
                }
                
                // Update journey step cards
                for (let i = 1; i <= TOTAL_STEPS; i++) {
                    const journeyStep = document.getElementById(`journey-step-${i}`);
                    if (journeyStep) {
                        journeyStep.className = 'journey-step';
                        
                        if (i < currentStep) {
                            journeyStep.classList.add('completed');
                        } else if (i === currentStep) {
                            journeyStep.classList.add('active');
                        } else {
                            journeyStep.classList.add('pending');
                        }
                    }
                }
                
                // Announce progress to screen readers
                announceToScreenReader(`Step ${currentStep} of ${TOTAL_STEPS}`);
            } catch (error) {
                console.error('Error updating progress:', error);
            }
        }

        function updateDisplay() {
            try {
                // Hide all steps with modern approach
                for (let i = 1; i <= TOTAL_STEPS; i++) {
                    const stepElement = document.getElementById(`step${i}`);
                    if (stepElement) {
                        stepElement.classList.add('hidden');
                    }
                }
                
                // Show current step
                const currentStepElement = document.getElementById(`step${currentStep}`);
                if (currentStepElement) {
                    currentStepElement.classList.remove('hidden');
                    currentStepElement.classList.add('fade-in');
                }
                
                // Smooth scroll to top with modern options
                window.scrollTo({ 
                    top: 0, 
                    behavior: 'smooth' 
                });
                
                // Update navigation buttons with cached references
                if (elements.prevBtn) {
                    elements.prevBtn.classList.toggle('hidden', currentStep === 1);
                }
                if (elements.nextBtn) {
                    elements.nextBtn.classList.toggle('hidden', currentStep === TOTAL_STEPS);
                }
                if (elements.submitBtn) {
                    elements.submitBtn.classList.toggle('hidden', currentStep !== TOTAL_STEPS);
                }
                
                updateProgress();
            } catch (error) {
                console.error('Error updating display:', error);
                announceError('Error updating form display');
            }
        }

        function validateCurrentStep() {
            try {
                const currentStepElement = document.getElementById(`step${currentStep}`);
                if (!currentStepElement) {
                    throw new Error('Current step element not found');
                }
                
                const requiredFields = currentStepElement.querySelectorAll('[required]');
                let isValid = true;
                const errors = [];
                
                // Clear previous error states
                currentStepElement.querySelectorAll('.error').forEach(field => {
                    field.classList.remove('error');
                });
                
                // Validate each required field
                for (const field of requiredFields) {
                    // Skip validation if field or its parent is hidden
                    const parentDiv = field.closest('div[id$="Field"]') || field.closest('div[id*="Details"]');
                    if (parentDiv && parentDiv.style.display === 'none') {
                        continue; // Skip hidden conditional fields
                    }
                    
                    // Also check if the field itself is hidden
                    if (field.style.display === 'none' || field.offsetParent === null) {
                        continue; // Skip hidden fields
                    }
                    
                    if (field.type === 'radio') {
                        const radioGroup = currentStepElement.querySelectorAll(`input[name="${field.name}"]`);
                        const isChecked = Array.from(radioGroup).some(radio => radio.checked);
                        if (!isChecked) {
                            radioGroup.forEach(radio => {
                                const label = radio.closest('label');
                                if (label) {
                                    label.style.borderColor = '#EF4444';
                                }
                            });
                            errors.push(`Please select a ${field.name} option`);
                            isValid = false;
                        }
                    } else if (field.type === 'checkbox' && field.hasAttribute('required')) {
                        if (!field.checked) {
                            field.classList.add('error');
                            errors.push('Please check the required checkbox');
                            isValid = false;
                        }
                    } else if (!field.value.trim()) {
                        field.classList.add('error');
                        const label = field.previousElementSibling?.textContent || field.name;
                        errors.push(`Please fill in ${label}`);
                        isValid = false;
                    }
                }
                
                // Special validation for signature on step 6
                if (currentStep === TOTAL_STEPS) {
                    if (signaturePad?.isEmpty()) {
                        const signatureError = document.getElementById('signatureError');
                        if (signatureError) {
                            signatureError.classList.remove('hidden');
                        }
                        errors.push('Signature is required');
                        isValid = false;
                    } else {
                        const signatureError = document.getElementById('signatureError');
                        if (signatureError) {
                            signatureError.classList.add('hidden');
                        }
                    }
                }
                
                // Announce validation results to screen readers
                if (!isValid) {
                    announceError(`Form validation failed: ${errors.join(', ')}`);
                }
                
                return isValid;
            } catch (error) {
                console.error('Error validating current step:', error);
                announceError('Form validation error occurred');
                return false;
            }
        }

        function nextStep() {
            try {
                if (validateCurrentStep()) {
                    saveCurrentStepData();
                    if (currentStep < TOTAL_STEPS) {
                        currentStep++;
                        updateDisplay();
                        announceToScreenReader(`Moved to step ${currentStep}`);
                    }
                } else {
                    // Use modern approach instead of alert
                    announceError('Please fill in all required fields before continuing.');
                    
                    // Focus on first invalid field for accessibility
                    const firstErrorField = document.querySelector(`#step${currentStep} .error`);
                    if (firstErrorField) {
                        firstErrorField.focus();
                    }
                }
            } catch (error) {
                console.error('Error navigating to next step:', error);
                announceError('Navigation error occurred');
            }
        }

        function prevStep() {
            try {
                if (currentStep > 1) {
                    saveCurrentStepData();
                    currentStep--;
                    updateDisplay();
                    announceToScreenReader(`Moved back to step ${currentStep}`);
                }
            } catch (error) {
                console.error('Error navigating to previous step:', error);
                announceError('Navigation error occurred');
            }
        }

        function saveCurrentStepData() {
            try {
                const currentStepElement = document.getElementById(`step${currentStep}`);
                if (!currentStepElement) {
                    throw new Error('Current step element not found');
                }
                
                const formElements = currentStepElement.querySelectorAll('input, select, textarea');
                
                formElements.forEach(element => {
                    // Input sanitization for security
                    const sanitizedValue = element.value?.trim();
                    
                    if (element.type === 'radio' || element.type === 'checkbox') {
                        if (element.checked) {
                            if (!formData[element.name]) {
                                formData[element.name] = [];
                            }
                            // Sanitize checkbox/radio values
                            formData[element.name].push(sanitizedValue);
                        }
                    } else if (sanitizedValue) {
                        // Only save non-empty values and sanitize them
                        formData[element.name] = sanitizedValue;
                    }
                });
                
                // Save signature if on final step
                if (currentStep === TOTAL_STEPS && signaturePad && !signaturePad.isEmpty()) {
                    formData.signature = signaturePad.toDataURL();
                }
            } catch (error) {
                console.error('Error saving current step data:', error);
                announceError('Error saving form data');
            }
        }

        function saveProgress() {
            try {
                saveCurrentStepData();
                
                const progressData = {
                    currentStep: currentStep,
                    formData: formData,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('fsaFormProgress', JSON.stringify(progressData));
                
                // Show success message with modern approach
                if (elements.saveProgressBtn) {
                    const originalText = elements.saveProgressBtn.textContent;
                    elements.saveProgressBtn.textContent = '✓ Saved!';
                    elements.saveProgressBtn.style.backgroundColor = '#A4C639';
                    
                    setTimeout(() => {
                        if (elements.saveProgressBtn) {
                            elements.saveProgressBtn.textContent = originalText;
                            elements.saveProgressBtn.style.backgroundColor = '';
                        }
                    }, 2000);
                }
                
                announceToScreenReader('Progress saved successfully');
            } catch (error) {
                console.error('Error saving progress:', error);
                announceError('Failed to save progress');
            }
        }

        function loadSavedProgress() {
            try {
                const saved = localStorage.getItem('fsaFormProgress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    
                    // Validate the saved data structure
                    if (progress.currentStep && progress.formData) {
                        currentStep = Math.min(Math.max(progress.currentStep, 1), TOTAL_STEPS);
                        formData = progress.formData;
                        
                        // Restore form values with error handling
                        Object.keys(formData).forEach(name => {
                            try {
                                const formElements = document.querySelectorAll(`[name="${name}"]`);
                                formElements.forEach(element => {
                                    if (element.type === 'radio' || element.type === 'checkbox') {
                                        element.checked = Array.isArray(formData[name]) && 
                                            formData[name].includes(element.value);
                                    } else {
                                        element.value = formData[name] || '';
                                    }
                                });
                            } catch (fieldError) {
                                console.warn(`Error restoring field ${name}:`, fieldError);
                            }
                        });
                        
                        // Restore signature with error handling
                        if (formData.signature && signaturePad) {
                            try {
                                signaturePad.fromDataURL(formData.signature);
                            } catch (signatureError) {
                                console.warn('Error restoring signature:', signatureError);
                            }
                        }
                        
                        announceToScreenReader('Previous progress restored');
                    }
                }
            } catch (error) {
                console.error('Error loading saved progress:', error);
                // Clear corrupted data
                try {
                    localStorage.removeItem('fsaFormProgress');
                } catch (cleanupError) {
                    console.error('Error clearing corrupted progress:', cleanupError);
                }
            }
        }

        // Collect all form fields regardless of their current state or visibility
        function collectAllFormData() {
            const allFormData = {
                form_type: 'FSA_Administration_Adoption_Agreement',
                submittedAt: new Date().toISOString(),
                formVersion: '2.1',
                currentStep: currentStep,
                userAgent: navigator.userAgent
            };
            
            // Get all form elements
            const form = document.getElementById('fsaForm');
            if (form) {
                const formData = new FormData(form);
                
                // Convert FormData to object and include all fields
                for (let [key, value] of formData.entries()) {
                    allFormData[key] = value;
                }
            }
            
            // Collect all input fields explicitly (including hidden, disabled, etc.)
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(input => {
                const name = input.name || input.id;
                if (name) {
                    if (input.type === 'checkbox' || input.type === 'radio') {
                        // For radio/checkbox, send both the value and checked state
                        allFormData[`${name}_value`] = input.value;
                        allFormData[`${name}_checked`] = input.checked;
                        if (input.checked) {
                            allFormData[name] = input.value;
                        }
                    } else if (input.type === 'file') {
                        // For file inputs, send file info if available
                        allFormData[`${name}_hasFile`] = input.files && input.files.length > 0;
                        if (input.files && input.files.length > 0) {
                            allFormData[`${name}_fileName`] = input.files[0].name;
                            allFormData[`${name}_fileSize`] = input.files[0].size;
                        }
                    } else {
                        // For all other inputs, send the value
                        allFormData[name] = input.value || '';
                    }
                }
            });
            
            // Add signature data if available
            if (signaturePad && !signaturePad.isEmpty()) {
                allFormData.signature = signaturePad.toDataURL();
                allFormData.signature_isEmpty = false;
            } else {
                allFormData.signature = '';
                allFormData.signature_isEmpty = true;
            }
            
            // Include localStorage data if available
            try {
                const savedProgress = localStorage.getItem('fsaFormProgress');
                if (savedProgress) {
                    const progressData = JSON.parse(savedProgress);
                    allFormData.savedProgress = progressData;
                }
            } catch (error) {
                console.warn('Could not retrieve saved progress:', error);
            }
            
            return allFormData;
        }
        
        // Webhook submission with fallback
        async function submitToWebhook(data) {
            const webhookUrl = 'https://hook.us2.make.com/bz1o8ehpn60xi7zzlejkryq3lw244eng';
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout
                
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data),
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                return { success: true, response };
                
            } catch (error) {
                console.warn('Primary webhook failed:', error);
                
                // Fallback to iframe submission
                try {
                    return await submitFallback(data);
                } catch (fallbackError) {
                    console.error('Both webhook and fallback failed:', fallbackError);
                    throw new Error('All submission methods failed');
                }
            }
        }
        
        // Iframe fallback submission
        function submitFallback(data) {
            return new Promise((resolve, reject) => {
                try {
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.name = 'webhook-fallback';
                    document.body.appendChild(iframe);
                    
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = 'https://hook.us2.make.com/bz1o8ehpn60xi7zzlejkryq3lw244eng';
                    form.target = 'webhook-fallback';
                    
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = 'data';
                    input.value = JSON.stringify(data);
                    form.appendChild(input);
                    
                    document.body.appendChild(form);
                    form.submit();
                    
                    // Cleanup after delay
                    setTimeout(() => {
                        try {
                            document.body.removeChild(iframe);
                            document.body.removeChild(form);
                        } catch (cleanupError) {
                            console.warn('Cleanup error:', cleanupError);
                        }
                        resolve({ success: true, method: 'fallback' });
                    }, 5000);
                    
                } catch (error) {
                    reject(error);
                }
            });
        }

        async function submitForm(e) {
            e.preventDefault();
            
            try {
                // Validate current step first
                if (!validateCurrentStep()) {
                    announceError('Please complete all required fields and provide your signature before submitting.');
                    // Focus on first error for accessibility
                    const firstError = document.querySelector(`#step${currentStep} .error`);
                    if (firstError) {
                        firstError.focus();
                    }
                    return;
                }
                
                // Show loading state
                const submitButton = e.target.querySelector('button[type="submit"]') || document.querySelector('button[type="submit"]');
                if (submitButton) {
                    submitButton.disabled = true;
                    submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...';
                }
                
                announceToScreenReader('Submitting form, please wait...');
                
                // Collect all form data (including empty fields)
                const allFormData = collectAllFormData();
                
                // Log for debugging
                console.log('Complete FSA Form Data:', allFormData);
                
                // Submit to webhook
                const result = await submitToWebhook(allFormData);
                
                if (result.success) {
                    // Show success animation
                    showSuccessAnimation();
                    
                    // Clean up localStorage
                    try {
                        localStorage.removeItem('fsaFormProgress');
                    } catch (storageError) {
                        console.warn('Could not clear localStorage:', storageError);
                    }
                    
                    // Reset form state after delay
                    setTimeout(() => {
                        if (elements.form) {
                            elements.form.reset();
                        }
                        if (signaturePad) {
                            signaturePad.clear();
                        }
                        currentStep = 1;
                        formData = {};
                        updateDisplay();
                    }, 3000);
                    
                } else {
                    throw new Error('Submission failed');
                }
                
            } catch (error) {
                console.error('Form submission error:', error);
                announceError('Form submission failed. Please check your internet connection and try again.');
                
                // Show error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50';
                errorDiv.innerHTML = `
                    <strong>Error!</strong> Form submission failed. Please try again.
                    <button onclick="this.parentElement.remove()" class="ml-4 text-red-500 hover:text-red-700">&times;</button>
                `;
                document.body.appendChild(errorDiv);
                
                // Auto-remove error message after 10 seconds
                setTimeout(() => {
                    if (errorDiv.parentElement) {
                        errorDiv.remove();
                    }
                }, 10000);
                
            } finally {
                // Re-enable submit button
                const submitButton = document.querySelector('button[type="submit"]');
                if (submitButton) {
                    submitButton.disabled = false;
                    submitButton.innerHTML = 'Complete Agreement';
                }
            }
        }

        // Initialize the form when page loads
        updateDisplay();
        
        // ==========================================
        // ANIME.JS ANIMATIONS
        // ==========================================
        function initAnimeAnimations() {
            if (typeof anime === 'undefined') {
                console.warn('Anime.js not available');
                return;
            }
            
            try {
                // Animate header on load
                anime({
                    targets: 'header.animate-in',
                    opacity: [0, 1],
                    translateY: [-30, 0],
                    duration: 1200,
                    easing: 'easeOutExpo'
                });
                
                // Animate journey tracker
                anime({
                    targets: '#journey-tracker',
                    opacity: [0, 1],
                    translateY: [30, 0],
                    duration: 1000,
                    delay: 300,
                    easing: 'easeOutExpo'
                });
                
                // Animate journey step cards
                anime({
                    targets: '.journey-step',
                    opacity: [0, 1],
                    translateY: [30, 0],
                    scale: [0.9, 1],
                    delay: anime.stagger(80, {start: 600}),
                    duration: 800,
                    easing: 'easeOutElastic(1, .6)'
                });
                
                // Button hover animations
                const buttons = document.querySelectorAll('.btn-primary, .btn-secondary');
                buttons.forEach(button => {
                    button.addEventListener('mouseenter', function() {
                        anime({
                            targets: this,
                            scale: 1.05,
                            duration: 300,
                            easing: 'easeOutQuad'
                        });
                    });
                    
                    button.addEventListener('mouseleave', function() {
                        anime({
                            targets: this,
                            scale: 1,
                            duration: 300,
                            easing: 'easeOutQuad'
                        });
                    });
                });
                
                // Form field focus animations
                const formInputs = document.querySelectorAll('.form-input');
                formInputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        anime({
                            targets: this,
                            scale: [1, 1.02, 1],
                            duration: 600,
                            easing: 'easeInOutQuad'
                        });
                    });
                });
                
            } catch (error) {
                console.error('Error initializing Anime.js:', error);
            }
        }
        
        // ==========================================
        // ENHANCED STEP TRANSITION
        // ==========================================
        const originalUpdateDisplay = updateDisplay;
        updateDisplay = function() {
            originalUpdateDisplay();
            
            // Animate step cards
            if (typeof anime !== 'undefined') {
                const currentStepElement = document.getElementById(`step${currentStep}`);
                if (currentStepElement) {
                    anime({
                        targets: currentStepElement,
                        opacity: [0, 1],
                        translateX: [50, 0],
                        duration: 800,
                        easing: 'easeOutExpo'
                    });
                    
                    // Animate form groups within the step
                    anime({
                        targets: `#step${currentStep} .field-group`,
                        opacity: [0, 1],
                        translateY: [20, 0],
                        delay: anime.stagger(50, {start: 200}),
                        duration: 600,
                        easing: 'easeOutQuad'
                    });
                }
                
                // Animate progress bar
                anime({
                    targets: '#progressBar',
                    width: `${(currentStep / TOTAL_STEPS) * 100}%`,
                    duration: 1000,
                    easing: 'easeInOutQuad'
                });
                
                // Pulse active journey step
                anime({
                    targets: `#journey-step-${currentStep}`,
                    scale: [1, 1.05, 1],
                    duration: 600,
                    easing: 'easeInOutQuad'
                });
                
                // Animate checkmarks for completed steps
                for (let i = 1; i < currentStep; i++) {
                    const checkmark = document.querySelector(`#journey-step-${i} .journey-checkmark`);
                    if (checkmark) {
                        anime({
                            targets: checkmark,
                            scale: [0, 1.2, 1],
                            rotate: [0, 360],
                            duration: 600,
                            delay: i * 100,
                            easing: 'easeOutElastic(1, .6)'
                        });
                    }
                }
            }
        };
        
        // ==========================================
        // ENHANCED FORM SUBMISSION SUCCESS
        // ==========================================
        function showSuccessAnimation() {
            if (typeof anime === 'undefined') return;
            
            // Create success overlay
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            overlay.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center" style="opacity: 0;">
                    <div class="success-checkmark mb-6">
                        <div class="check-icon">
                            <span class="icon-line line-tip"></span>
                            <span class="icon-line line-long"></span>
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold nue-primary-text mb-2">Success!</h3>
                    <p class="text-gray-600 mb-4">Your FSA Administration Adoption Agreement has been submitted successfully.</p>
                    <button onclick="this.closest('.fixed').remove()" class="btn-primary">Close</button>
                </div>
            `;
            
            document.body.appendChild(overlay);
            
            // Animate overlay
            anime({
                targets: overlay,
                opacity: [0, 1],
                duration: 300,
                easing: 'easeOutQuad'
            });
            
            // Animate success card
            anime({
                targets: overlay.querySelector('.bg-white'),
                opacity: [0, 1],
                scale: [0.8, 1],
                duration: 600,
                delay: 200,
                easing: 'easeOutElastic(1, .8)'
            });
            
            // Celebrate with confetti-like animation
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    width: 10px;
                    height: 10px;
                    background: ${i % 2 === 0 ? '#1E4E6B' : '#A4C639'};
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 9999;
                `;
                document.body.appendChild(particle);
                
                anime({
                    targets: particle,
                    translateX: anime.random(-300, 300),
                    translateY: [0, anime.random(300, 600)],
                    opacity: [1, 0],
                    scale: [1, 0],
                    rotate: anime.random(0, 360),
                    duration: anime.random(1000, 2000),
                    easing: 'easeOutQuad',
                    complete: () => particle.remove()
                });
            }
        }
        
        // ==========================================
        // INITIALIZE ALL ANIMATIONS
        // ==========================================
        window.addEventListener('load', function() {
            // Small delay to ensure DOM is fully ready
            setTimeout(() => {
                initAnimeAnimations();
            }, 100);
        });
        
    </script>
</body>
</html>